# 地图服务集成快速启动指南

## 概述
本指南将帮助您快速了解和使用物流系统中新增的地图服务功能，包括停靠点管理、车辆追踪和路线规划等功能。

## 前端页面导航

### 管理员端 (Admin Web)
访问路径: `http://localhost:3000/admin-web/public/`

1. **地图服务管理** (`/map-management.html`)
   - 菜单路径: 首页 → 地图服务管理
   - 功能: 管理停靠点、服务提供商、车辆追踪等

2. **车辆位置追踪** (`/vehicle-tracking.html`)
   - 菜单路径: 首页 → 车辆位置追踪
   - 功能: 实时监控车辆位置和状态

### 承运商端 (Tenant Web)
访问路径: `http://localhost:3000/tenant-web/public/`

1. **停靠点管理** (`/map.html`)
   - 菜单路径: 控制台 → 停靠点管理
   - 功能: 管理承运商的停靠点

2. **地图服务管理** (`/map-management.html`)
   - 菜单路径: 控制台 → 地图服务管理
   - 功能: 更全面的地图服务功能

## 核心功能使用

### 1. 偌靠点管理
**管理员端和承运商端均可使用**

#### 添加停靠点
1. 进入"地图服务管理"或"停靠点管理"页面
2. 点击"添加停靠点"按钮
3. 填写停靠点信息：
   - 名称：停靠点名称
   - 类型：住宅区/商业区/工业区/其他
   - 地址：详细地址
   - 区域：所在区域
4. 点击"添加"按钮

#### 编辑/删除停靠点
- 在停靠点列表中，每行都有"编辑"和"删除"按钮
- 点击相应按钮进行操作

### 2. 车辆追踪
**管理员端和承运商端均可使用**

#### 实时追踪
1. 进入"车辆位置追踪"页面
2. 从下拉列表中选择要追踪的车辆
3. 选择追踪时长（1小时/6小时/12小时/24小时）
4. 点击"开始追踪"按钮
5. 地图上将显示车辆的实时位置

#### 查看历史轨迹
- 在车辆列表中点击"轨迹"按钮查看历史轨迹

### 3. 路线规划
**仅管理员端可用**

#### 计算路线
1. 进入"地图服务管理"页面
2. 切换到"路线规划"标签页
3. 输入起始位置和结束位置
4. 选择车辆类型
5. 点击"计算路线"按钮
6. 地图上将显示规划的路线

## API 接口说明

### 停靠点相关接口
```
GET /api/map/stop-points     # 获取停靠点列表
POST /api/map/stop-points    # 添加停靠点
DELETE /api/map/stop-points/{id}  # 删除停靠点
```

### 车辆追踪相关接口
```
GET /api/tracking/current-position/{vehicleId}  # 获取车辆当前位置
GET /api/tracking/history/{vehicleId}          # 获取车辆历史轨迹
POST /api/tracking/position-update             # 车辆位置更新回调
```

### 路线规划相关接口
```
GET /api/map/route                    # 获取路线规划
POST /api/av-route/calculate         # 无人车路径规划
```

## 前端开发说明

### 1. 页面结构
所有地图相关页面都遵循相同的结构：
- 侧边栏导航
- 顶部用户信息栏
- 主内容区域
- 响应式设计

### 2. JavaScript 功能
- 使用Fetch API进行数据交互
- 包含完整的错误处理机制
- 用户操作反馈提示
- 数据验证功能

### 3. 样式规范
- 使用统一的颜色主题（橙色为主色调）
- 响应式布局设计
- 一致的UI组件风格

## 测试步骤

### 功能测试
1. 登录系统（管理员或承运商账号）
2. 导航到地图相关页面
3. 测试CRUD操作（创建、读取、更新、删除）
4. 验证数据正确显示
5. 测试错误处理机制

### 集成测试
1. 确保API端点可访问
2. 验证数据传输正确性
3. 测试跨页面数据一致性
4. 验证用户权限控制

## 常见问题

### Q: 页面加载缓慢怎么办？
A: 检查网络连接，确保API服务正常运行

### Q: 添加停靠点失败怎么办？
A: 检查必填字段是否完整，确认API服务状态

### Q: 车辆位置不更新怎么办？
A: 确认车辆位置回传服务正常运行，检查API回调配置

### Q: 如何切换地图服务商？
A: 在系统配置中修改默认地图服务商设置

## 开发资源

### 代码位置
- 前端页面: `web/admin-web/public/` 和 `web/tenant-web/public/`
- API模拟: `web/api-mock/map-api.js`
- 文档: `docs/` 目录

### 依赖库
- Font Awesome: 图标库
- CSS Grid/Flexbox: 布局系统
- Fetch API: 数据交互

## 后续开发

### 近期计划
1. 集成真实地图服务商API
2. 实现实时位置推送功能
3. 优化地图可视化组件
4. 添加更多地图交互功能

### 长期规划
1. 支持更多地图服务商
2. 集成AI路径优化算法
3. 添加预测性分析功能
4. 实现AR导航功能

## 支持与反馈

如遇到问题或有改进建议，请联系开发团队或在项目issue中提交反馈。