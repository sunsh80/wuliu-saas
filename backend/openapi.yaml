openapi: 3.0.3
info:
  title: å¤šç§Ÿæˆ·ç‰©æµå¹³å° API
  version: 1.0.2-safe æŠ€æœ¯æ ˆ:Node.js + Express + SQLite + OpenAPI Backend è®¤è¯æœºåˆ¶:express-session(åŸºäº Cookie çš„ä¼šè¯ï¼‰ å®‰å…¨æ¨¡å‹ï¼šé€šè¿‡ TenantSessionAuth å®‰å…¨å¤„ç†å™¨æ ¡éªŒ req.session.userId å¤šç§Ÿæˆ·æ”¯æŒ:tenants è¡¨å­˜å‚¨ç§Ÿæˆ·,users è¡¨å­˜å‚¨ç§Ÿæˆ·å‘˜å·¥ & å°ç¨‹åºé¡¾å®¢
  description: |
    æ”¯æŒå®¢æˆ·ï¼ˆä¸‹å•æ–¹ï¼‰ä¸æ‰¿è¿æ–¹ï¼ˆæ¥å•æ–¹ï¼‰åŒè§’è‰²çš„ç‰©æµè®¢å•ç³»ç»Ÿã€‚
    - `/api/admin/...`ï¼šå¹³å°ç®¡ç†å‘˜
    - `/api/customer/...`ï¼šå®¢æˆ·ç§Ÿæˆ·
    - `/api/carrier/...`ï¼šæ‰¿è¿æ–¹ç§Ÿæˆ·
    - `/api/public/...`ï¼šå…¬å…±æ¥å£
    ğŸ”¹ æœ¬æ¬¡å¢å®¹(v1.0.2-safe):
    - ä¿ç•™æ‰€æœ‰ v1.0.1 å­—æ®µã€è·¯ç”±ã€çŠ¶æ€ä¸å˜
    - æ–°å¢æ‰¿è¿æ–¹èƒ½åŠ›ç”»åƒï¼ˆå¯é€‰ï¼‰
    - ç§Ÿæˆ·æœ¬èº«å¯ä»¥åœ¨ä¸€å®šæ¡ä»¶ä¸‹è½¬å˜ä¸ºæ‰¿è¿æ–¹ï¼Œå®¢æˆ·ï¼Œä»“åº“å®ä½“
    - æ–°å¢ä½“ç§¯ã€æ—¶æ•ˆç­‰å¯é€‰å­—æ®µ
    - æ–°å¢åŒ¹é…ç›¸å…³æ¥å£ï¼ˆä¸æ”¹åŠ¨åŸæœ‰ claim/award æµç¨‹ï¼‰
servers:
  - url: http://localhost:3000
    description: å¼€å‘ç¯å¢ƒ
tags:
  - name: setup
    description: å¹³å°åˆå§‹åŒ–ï¼ˆé¦–æ¬¡å®‰è£…ï¼‰
  - name: admin-auth
    description: å¹³å°ç®¡ç†å‘˜ - è®¤è¯ä¸ä¼šè¯
  - name: admin-user
    description: å¹³å°ç®¡ç†å‘˜ - ç”¨æˆ·ç®¡ç†
  - name: admin-tenant
    description: å¹³å°ç®¡ç†å‘˜ - ç§Ÿæˆ·ç®¡ç†
  - name: admin-order
    description: å¹³å°ç®¡ç†å‘˜ - è®¢å•ç®¡ç†
  - name: customer-order
    description: å®¢æˆ·ç§Ÿæˆ· - åˆ›å»ºä¸æŸ¥çœ‹è‡ªå·±çš„è®¢å•
  - name: carrier-order
    description: æ‰¿è¿æ–¹ç§Ÿæˆ· - è®¤é¢†ã€æ‰§è¡Œè®¢å•
  - name: public
    description: å…¬å…±æ¥å£ï¼ˆå°ç¨‹åºä½¿ç”¨ï¼Œæœªæ¥åºŸå¼ƒï¼‰
  - name: auth
    description: ç§Ÿæˆ·è®¤è¯ä¸ä¼šè¯
  - name: matching
    description: æ™ºèƒ½åŒ¹é…ï¼ˆæ–°å¢ï¼Œå¯é€‰ä½¿ç”¨ï¼‰
components:
  securitySchemes:
    AdminSessionAuth:
      type: apiKey
      in: cookie
      name: connect.sid
      description: å¹³å°ç®¡ç†å‘˜ç™»å½•åè‡ªåŠ¨æºå¸¦ï¼ˆç”± Express Session ç®¡ç†ï¼‰
    TenantSessionAuth:
      type: apiKey
      in: cookie
      name: connect.sid
      description: ç§Ÿæˆ·ç™»å½•åè‡ªåŠ¨æºå¸¦ï¼ˆç”± Express Session ç®¡ç†ï¼‰
  schemas:
    CustomerWebRegistration:
      type: object
      required:
        - contact_phone
        - password
        - roles
      properties:
        contact_phone:
          type: string
          pattern: ^1[3-9][0-9]{9}$
          example: '13800138000'
        password:
          type: string
          minLength: 6
          example: password123
        roles:
          type: array
          items:
            type: string
            enum:
              - customer
          example:
            - customer
    Username:
      type: string
      pattern: ^[a-zA-Z0-9_-]{3,20}$
      example: user_name_123
    Name:
      type: string
      pattern: ^[\u4e00-\u9fa5a-zA-Z0-9_-]{1,50}$
      example: å¼ ä¸‰
    Address:
      type: string
      pattern: ^[\u4e00-\u9fa5a-zA-Z0-9\s\S]{1,200}$
      example: åŒ—äº¬å¸‚æœé˜³åŒºæŸæŸè¡—é“123å·
    TenantApplication:
      type: object
      required:
        - name
        - contact_person
        - contact_phone
        - email
        - password
        - roles
      properties:
        name:
          $ref: '#/components/schemas/Name'
        contact_person:
          $ref: '#/components/schemas/Name'
        contact_phone:
          type: string
          pattern: ^1[3-9][0-9]{9}$
        email:
          type: string
          format: email
        password:
          type: string
          minLength: 6
        roles:
          type: array
          items:
            type: string
            enum:
              - customer
              - carrier
          minItems: 1
          example:
            - customer
            - carrier
        address:
          $ref: '#/components/schemas/Address'
        service_radius_km:
          type: integer
          minimum: 1
          example: 200
        capacity_kg:
          type: number
          minimum: 0.1
          example: 5000
        capacity_m3:
          type: number
          minimum: 0.1
          example: 30
        base_price_per_km:
          type: number
          minimum: 0.01
          example: 2.5
    TenantProfile:
      type: object
      properties:
        id:
          type: string
        name:
          $ref: '#/components/schemas/Name'
        contact_person:
          $ref: '#/components/schemas/Name'
        roles:
          type: array
          items:
            type: string
            enum:
              - customer
              - carrier
        address:
          $ref: '#/components/schemas/Address'
        service_radius_km:
          type: integer
        capacity_kg:
          type: number
        capacity_m3:
          type: number
        base_price_per_km:
          type: number
        avg_rating:
          type: number
          minimum: 0
          maximum: 5
    QuoteRequest:
      type: object
      required:
        - price
      properties:
        price:
          type: number
          minimum: 0.01
          example: 150
        estimated_hours:
          type: integer
          minimum: 1
          example: 24
        estimated_arrival:
          type: string
          format: date-time
          example: '2026-01-14T18:00:00Z'
        note:
          type: string
          example: è‡ªæœ‰è½¦è¾†,24å°æ—¶å†…è£…è½¦
    QuoteItem:
      type: object
      properties:
        id:
          type: string
        order_id:
          type: string
        carrier_tenant_id:
          type: string
        carrier_tenant_name:
          type: string
        price:
          type: number
        estimated_hours:
          type: integer
        estimated_arrival:
          type: string
          format: date-time
        avg_rating:
          type: number
        match_score:
          type: number
        note:
          type: string
        created_at:
          type: string
          format: date-time
    CreateOrderRequest:
      type: object
      required:
        - pickup_address
        - delivery_address
        - weight_kg
      properties:
        pickup_address:
          type: string
          example: åŒ—äº¬å¸‚æœé˜³åŒºXXå¤§å¦
        delivery_address:
          type: string
          example: ä¸Šæµ·å¸‚æµ¦ä¸œæ–°åŒºYYå›­åŒº
        weight_kg:
          type: number
          format: float
          minimum: 0.1
          example: 25.5
        cargo_type:
          type: string
          enum:
            - å®¶å…·å®¶ç”µ
            - è£…ä¿®å»ºæ
            - åŠå…¬ç”¨å“
            - å¿«é€’åŒ…è£¹
            - å…¶ä»–
          description: è´§ç‰©ç±»å‹
          example: å®¶å…·å®¶ç”µ
        cargo_remark:
          type: string
          description: è´§ç‰©å¤‡æ³¨
          example: æ˜“ç¢å“ï¼Œè¯·å°å¿ƒæ¬è¿
        length:
          type: number
          minimum: 0.01
          description: è´§ç‰©é•¿åº¦(ç±³)
          example: 1.2
        width:
          type: number
          minimum: 0.01
          description: è´§ç‰©å®½åº¦(ç±³)
          example: 0.8
        height:
          type: number
          minimum: 0.01
          description: è´§ç‰©é«˜åº¦(ç±³)
          example: 0.6
        vehicle_type:
          type: string
          enum:
            - æ— äººè½¦
            - æœ‰äººè½¦
          description: è½¦å‹è¦æ±‚
          example: æœ‰äººè½¦
        pickup_time:
          type: string
          format: date-time
          description: é¢„çº¦å–è´§æ—¶é—´
          example: '2026-01-15T10:00:00Z'
        volume_m3:
          type: number
          minimum: 0.01
          example: 1.2
        required_delivery_time:
          type: string
          format: date-time
          example: '2026-01-15T12:00:00Z'
        quote_deadline:
          type: string
          format: date-time
          example: '2026-01-14T10:00:00Z'
        customer_name:
          $ref: '#/components/schemas/Name'
        customer_phone:
          type: string
          pattern: ^1[3-9]\d{9}$
          example: '13800138000'
        description:
          type: string
          example: æ˜“ç¢å“ï¼Œè¯·è½»æ‹¿è½»æ”¾
    OrderItem:
      type: object
      properties:
        id:
          type: string
          example: order_123e4567-e89b-12d3-a456-426614174000
        customer_tenant_id:
          type: string
        customer_tenant_name:
          type: string
        carrier_tenant_id:
          type: string
          nullable: true
        carrier_tenant_name:
          type: string
          nullable: true
        pickup_address:
          type: string
        delivery_address:
          type: string
        weight_kg:
          type: number
        volume_m3:
          type: number
        required_delivery_time:
          type: string
          format: date-time
        quote_deadline:
          type: string
          format: date-time
        status:
          type: string
          enum:
            - created
            - pending
            - pending_claim
            - claimed
            - quoted
            - awarded
            - dispatched
            - in_transit
            - delivered
            - cancelled
        created_at:
          type: string
          format: date-time
        quotes:
          type: array
          items:
            $ref: '#/components/schemas/QuoteItem'
          nullable: true
        order_id:
          type: string
          example: ORD-20260205-001
          description: è®¢å•çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç”¨äºå‰ç«¯å±•ç¤ºå’Œè·³è½¬è¯¦æƒ…é¡µ
        updated_at:
          type: string
          format: date-time
          example: '2026-02-05T10:35:00Z'
          description: è®¢å•æœ€åæ›´æ–°æ—¶é—´
        sender_info:
          type: string
          example: '{"name": "å¼ ä¸‰", "phone": "13800138000"}'
          description: å‘è´§äººä¿¡æ¯ï¼ˆJSON å­—ç¬¦ä¸²æ ¼å¼ï¼‰
        receiver_info:
          type: string
          example: '{"name": "æå››", "phone": "13900139000"}'
          description: æ”¶è´§äººä¿¡æ¯ï¼ˆJSON å­—ç¬¦ä¸²æ ¼å¼ï¼‰
        cargo_type:
          type: string
          example: furniture
          description: è´§ç‰©ç±»å‹
        length:
          type: number
          example: 1.2
          description: è´§ç‰©é•¿åº¦ï¼ˆç±³ï¼‰
        width:
          type: number
          example: 0.8
          description: è´§ç‰©å®½åº¦ï¼ˆç±³ï¼‰
        height:
          type: number
          example: 0.6
          description: è´§ç‰©é«˜åº¦ï¼ˆç±³ï¼‰
        description:
          type: string
          example: è¯·åŠ¡å¿…å°å¿ƒè½»æ”¾
          description: è®¢å•å¤‡æ³¨
        total_price:
          type: number
          example: 299.99
          description: è®¢å•æ€»ä»·æ ¼
      required:
        - id
        - order_id
        - status
        - created_at
        - pickup_address
        - delivery_address
        - sender_info
        - receiver_info
        - cargo_type
        - weight_kg
        - length
        - width
        - height
        - volume_m3
        - total_price
        - customer_tenant_id
        - customer_tenant_name
    OrderListResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: è·å–æˆåŠŸ
        data:
          type: object
          properties:
            total:
              type: integer
              example: 5
            page:
              type: integer
              example: 1
            limit:
              type: integer
              example: 10
            orders:
              type: array
              items:
                $ref: '#/components/schemas/OrderItem'
      required:
        - success
        - data
    ErrorResponse:
      type: object
      required:
        - error
        - message
      properties:
        error:
          type: string
          example: TENANT_ROLE_NOT_ENABLED
        message:
          type: string
          example: å½“å‰ç§Ÿæˆ·æœªå¯ç”¨å®¢æˆ·è§’è‰²
    TenantListItem:
      type: object
      properties:
        id:
          type: integer
        name:
          $ref: '#/components/schemas/Name'
        contact_person:
          $ref: '#/components/schemas/Name'
        contact_phone:
          type: string
          pattern: ^1[3-9][0-9]{9}$
        email:
          type: string
          format: email
        status:
          type: string
          enum:
            - pending
            - approved
            - rejected
            - active
            - inactive
        created_at:
          type: string
          format: date-time
        address:
          type: string
        service_radius_km:
          type: integer
        capacity_kg:
          type: number
        capacity_m3:
          type: number
        base_price_per_km:
          type: number
        avg_rating:
          type: number
          minimum: 0
          maximum: 5
    TenantDetail:
      allOf:
        - $ref: '#/components/schemas/TenantListItem'
        - type: object
          properties:
            updated_at:
              type: string
              format: date-time
            vehicles:
              type: array
              items:
                $ref: '#/components/schemas/VehicleInfo'
            financial_info:
              $ref: '#/components/schemas/TenantFinancialInfo'
            contact_info:
              $ref: '#/components/schemas/TenantContactInfo'
    VehicleInfo:
      type: object
      properties:
        id:
          type: integer
        plate_number:
          type: string
        type:
          type: string
        length:
          type: number
        width:
          type: number
        height:
          type: number
        max_weight:
          type: number
        volume:
          type: number
        status:
          type: string
        driver_name:
          type: string
        driver_phone:
          type: string
        image_url:
          type: string
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    TenantFinancialInfo:
      type: object
      properties:
        bank_account_number:
          type: string
        bank_name:
          type: string
        tax_id:
          type: string
        settlement_cycle:
          type: string
        credit_limit:
          type: number
        outstanding_balance:
          type: number
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    TenantContactInfo:
      type: object
      properties:
        finance_contact_name:
          type: string
        finance_contact_phone:
          type: string
        finance_contact_email:
          type: string
        support_contact_name:
          type: string
        support_contact_phone:
          type: string
        support_contact_email:
          type: string
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    PaginationInfo:
      type: object
      properties:
        current_page:
          type: integer
          example: 1
        per_page:
          type: integer
          example: 10
        total:
          type: integer
          example: 100
        total_pages:
          type: integer
          example: 10
        has_next:
          type: boolean
          example: true
        has_prev:
          type: boolean
          example: false
    PricingRule:
      type: object
      properties:
        id:
          type: integer
          example: 1
        rule_name:
          type: string
          example: æ ‡å‡†å®šä»·è§„åˆ™
        base_price:
          type: number
          example: 10
        price_per_km:
          type: number
          example: 2.5
        price_per_hour:
          type: number
          example: 5
        price_per_kg:
          type: number
          example: 1
        cold_storage_surcharge:
          type: number
          example: 0.5
        peak_hour_multiplier:
          type: number
          example: 1.5
        off_peak_hour_multiplier:
          type: number
          example: 0.8
        weather_multiplier:
          type: number
          example: 1.2
        min_price:
          type: number
          example: 5
        max_price:
          type: number
          example: 1000
        time_slot_rules:
          type: object
          example: {}
        region_rules:
          type: object
          example: {}
        vehicle_type_rules:
          type: object
          example: {}
        active:
          type: boolean
          example: true
        created_at:
          type: string
          format: date-time
          example: '2026-01-25T15:30:00Z'
        updated_at:
          type: string
          format: date-time
          example: '2026-01-25T15:30:00Z'
    CreatePricingRuleRequest:
      type: object
      required:
        - rule_name
      properties:
        rule_name:
          type: string
          example: æ ‡å‡†å®šä»·è§„åˆ™
          description: å®šä»·è§„åˆ™åç§°
        base_price:
          type: number
          example: 10
          description: åŸºç¡€ä»·æ ¼
        price_per_km:
          type: number
          example: 2.5
          description: æ¯å…¬é‡Œä»·æ ¼
        price_per_hour:
          type: number
          example: 5
          description: æ¯å°æ—¶ä»·æ ¼
        price_per_kg:
          type: number
          example: 1
          description: æ¯å…¬æ–¤ä»·æ ¼
        cold_storage_surcharge:
          type: number
          example: 0.5
          description: å†·è—é™„åŠ è´¹
        peak_hour_multiplier:
          type: number
          example: 1.5
          description: é«˜å³°æ—¶æ®µå€ç‡
        off_peak_hour_multiplier:
          type: number
          example: 0.8
          description: éé«˜å³°æ—¶æ®µå€ç‡
        weather_multiplier:
          type: number
          example: 1.2
          description: å¤©æ°”å€ç‡
        min_price:
          type: number
          example: 5
          description: æœ€ä½ä»·æ ¼
        max_price:
          type: number
          example: 1000
          description: æœ€é«˜ä»·æ ¼
        time_slot_rules:
          type: object
          description: æ—¶æ®µè§„åˆ™
        region_rules:
          type: object
          description: åœ°åŒºè§„åˆ™
        vehicle_type_rules:
          type: object
          description: è½¦å‹è§„åˆ™
        active:
          type: boolean
          example: true
          description: æ˜¯å¦æ¿€æ´»
    UpdatePricingRuleRequest:
      type: object
      properties:
        rule_name:
          type: string
          example: æ ‡å‡†å®šä»·è§„åˆ™
          description: å®šä»·è§„åˆ™åç§°
        base_price:
          type: number
          example: 10
          description: åŸºç¡€ä»·æ ¼
        price_per_km:
          type: number
          example: 2.5
          description: æ¯å…¬é‡Œä»·æ ¼
        price_per_hour:
          type: number
          example: 5
          description: æ¯å°æ—¶ä»·æ ¼
        price_per_kg:
          type: number
          example: 1
          description: æ¯å…¬æ–¤ä»·æ ¼
        cold_storage_surcharge:
          type: number
          example: 0.5
          description: å†·è—é™„åŠ è´¹
        peak_hour_multiplier:
          type: number
          example: 1.5
          description: é«˜å³°æ—¶æ®µå€ç‡
        off_peak_hour_multiplier:
          type: number
          example: 0.8
          description: éé«˜å³°æ—¶æ®µå€ç‡
        weather_multiplier:
          type: number
          example: 1.2
          description: å¤©æ°”å€ç‡
        min_price:
          type: number
          example: 5
          description: æœ€ä½ä»·æ ¼
        max_price:
          type: number
          example: 1000
          description: æœ€é«˜ä»·æ ¼
        time_slot_rules:
          type: object
          description: æ—¶æ®µè§„åˆ™
        region_rules:
          type: object
          description: åœ°åŒºè§„åˆ™
        vehicle_type_rules:
          type: object
          description: è½¦å‹è§„åˆ™
        active:
          type: boolean
          description: æ˜¯å¦æ¿€æ´»
    Pagination:
      type: object
      properties:
        current_page:
          type: integer
          example: 1
        per_page:
          type: integer
          example: 10
        total:
          type: integer
          example: 100
        total_pages:
          type: integer
          example: 10
        has_next:
          type: boolean
          example: true
        has_prev:
          type: boolean
          example: false
    CarrierPricingConfig:
      type: object
      properties:
        id:
          type: integer
          example: 1
        carrier_id:
          type: integer
          example: 1
        config_name:
          type: string
          example: æ ‡å‡†é…é€å®šä»·
        base_price:
          type: number
          example: 15
        price_per_km:
          type: number
          example: 3
        price_per_hour:
          type: number
          example: 6
        price_per_kg:
          type: number
          example: 1.5
        cold_storage_surcharge:
          type: number
          example: 0.8
        peak_hour_multiplier:
          type: number
          example: 1.8
        off_peak_hour_multiplier:
          type: number
          example: 0.7
        weather_multiplier:
          type: number
          example: 1.3
        min_price:
          type: number
          example: 8
        max_price:
          type: number
          example: 200
        time_slot_rules:
          type: object
          example: {}
        region_rules:
          type: object
          example: {}
        vehicle_type_rules:
          type: object
          example: {}
        active:
          type: boolean
          example: true
        created_at:
          type: string
          format: date-time
          example: '2026-01-25T15:30:00Z'
        updated_at:
          type: string
          format: date-time
          example: '2026-01-25T15:30:00Z'
    CreateCarrierPricingConfigRequest:
      type: object
      required:
        - carrier_id
        - config_name
      properties:
        carrier_id:
          type: integer
          example: 1
          description: æ‰¿è¿å•†ID
        config_name:
          type: string
          example: æ ‡å‡†é…é€å®šä»·
          description: é…ç½®åç§°
        base_price:
          type: number
          example: 15
          description: åŸºç¡€ä»·æ ¼
        price_per_km:
          type: number
          example: 3
          description: æ¯å…¬é‡Œä»·æ ¼
        price_per_hour:
          type: number
          example: 6
          description: æ¯å°æ—¶ä»·æ ¼
        price_per_kg:
          type: number
          example: 1.5
          description: æ¯å…¬æ–¤ä»·æ ¼
        cold_storage_surcharge:
          type: number
          example: 0.8
          description: å†·è—é™„åŠ è´¹
        peak_hour_multiplier:
          type: number
          example: 1.8
          description: é«˜å³°æ—¶æ®µå€ç‡
        off_peak_hour_multiplier:
          type: number
          example: 0.7
          description: éé«˜å³°æ—¶æ®µå€ç‡
        weather_multiplier:
          type: number
          example: 1.3
          description: å¤©æ°”å€ç‡
        min_price:
          type: number
          example: 8
          description: æœ€ä½ä»·æ ¼
        max_price:
          type: number
          example: 200
          description: æœ€é«˜ä»·æ ¼
        time_slot_rules:
          type: object
          description: æ—¶æ®µè§„åˆ™
        region_rules:
          type: object
          description: åœ°åŒºè§„åˆ™
        vehicle_type_rules:
          type: object
          description: è½¦å‹è§„åˆ™
        active:
          type: boolean
          example: true
          description: æ˜¯å¦æ¿€æ´»
    UpdateCarrierPricingConfigRequest:
      type: object
      properties:
        config_name:
          type: string
          example: æ ‡å‡†é…é€å®šä»·
          description: é…ç½®åç§°
        base_price:
          type: number
          example: 15
          description: åŸºç¡€ä»·æ ¼
        price_per_km:
          type: number
          example: 3
          description: æ¯å…¬é‡Œä»·æ ¼
        price_per_hour:
          type: number
          example: 6
          description: æ¯å°æ—¶ä»·æ ¼
        price_per_kg:
          type: number
          example: 1.5
          description: æ¯å…¬æ–¤ä»·æ ¼
        cold_storage_surcharge:
          type: number
          example: 0.8
          description: å†·è—é™„åŠ è´¹
        peak_hour_multiplier:
          type: number
          example: 1.8
          description: é«˜å³°æ—¶æ®µå€ç‡
        off_peak_hour_multiplier:
          type: number
          example: 0.7
          description: éé«˜å³°æ—¶æ®µå€ç‡
        weather_multiplier:
          type: number
          example: 1.3
          description: å¤©æ°”å€ç‡
        min_price:
          type: number
          example: 8
          description: æœ€ä½ä»·æ ¼
        max_price:
          type: number
          example: 200
          description: æœ€é«˜ä»·æ ¼
        time_slot_rules:
          type: object
          description: æ—¶æ®µè§„åˆ™
        region_rules:
          type: object
          description: åœ°åŒºè§„åˆ™
        vehicle_type_rules:
          type: object
          description: è½¦å‹è§„åˆ™
        active:
          type: boolean
          description: æ˜¯å¦æ¿€æ´»
    OrderDetails:
      type: object
      properties:
        distance_km:
          type: number
          example: 15.5
        duration_hours:
          type: number
          example: 2.5
        weight_kg:
          type: number
          example: 100
        is_cold_storage:
          type: boolean
          example: false
        time_slot:
          type: string
          example: morning
        weather_condition:
          type: string
          example: normal
        region:
          type: string
          example: beijing_haidian
        vehicle_type:
          type: string
          example: van
        pickup_address:
          type: string
          example: åŒ—äº¬å¸‚æµ·æ·€åŒºä¸­å…³æ‘å¤§è¡—1å·
        delivery_address:
          type: string
          example: åŒ—äº¬å¸‚æœé˜³åŒºå›½è´¸å¤§å¦
        cargo_type:
          type: string
          example: electronics
    CarrierQuote:
      type: object
      properties:
        carrier_id:
          type: integer
          example: 1
        carrier_name:
          type: string
          example: é¡ºä¸°é€Ÿè¿
        avg_rating:
          type: number
          example: 4.8
        price:
          type: number
          example: 150
        base_price:
          type: number
          example: 10
        distance_cost:
          type: number
          example: 37.5
        duration_cost:
          type: number
          example: 12.5
        weight_cost:
          type: number
          example: 100
        cold_storage_surcharge:
          type: number
          example: 0
        time_slot_multiplier:
          type: number
          example: 1
        region_multiplier:
          type: number
          example: 1
        vehicle_type_multiplier:
          type: number
          example: 1
        weather_multiplier:
          type: number
          example: 1
        peak_hour_multiplier:
          type: number
          example: 1
        off_peak_multiplier:
          type: number
          example: 1
    AddonsConfig:
      type: object
      properties:
        loading_fee:
          type: number
          example: 50
          description: è£…å¸è´¹
        waiting_fee:
          type: number
          example: 30
          description: ç­‰å¾…è´¹
        overtime_fee:
          type: number
          example: 100
          description: è¶…æ—¶è´¹
        special_handling_fee:
          type: number
          example: 80
          description: ç‰¹æ®Šå¤„ç†è´¹
        cold_storage_fee:
          type: number
          example: 40
          description: å†·è—é™„åŠ è´¹
        insurance_fee:
          type: number
          example: 20
          description: ä¿é™©è´¹
        other_fees:
          type: array
          items:
            type: object
            properties:
              name:
                type: string
                example: å¤œé—´é…é€è´¹
              amount:
                type: number
                example: 60
              description:
                type: string
                example: å¤œé—´é…é€é¢å¤–è´¹ç”¨
  responses:
    UnauthorizedError:
      description: æœªè®¤è¯
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    ForbiddenError:
      description: æƒé™ä¸è¶³ï¼ˆå¦‚è§’è‰²ä¸åŒ¹é…ï¼‰
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    NotFoundError:
      description: èµ„æºæœªæ‰¾åˆ°
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              error:
                type: string
                example: NOT_FOUND
              message:
                type: string
                example: èµ„æºæœªæ‰¾åˆ°
    InternalServerError:
      description: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              error:
                type: string
                example: INTERNAL_SERVER_ERROR
              message:
                type: string
                example: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯
    BadRequestError:
      description: è¯·æ±‚å‚æ•°é”™è¯¯
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              error:
                type: string
                example: BAD_REQUEST
              message:
                type: string
                example: è¯·æ±‚å‚æ•°é”™è¯¯
paths:
  /api/admin/tenants:
    get:
      tags:
        - admin-tenant
      operationId: listAllTenants
      summary: è·å–æ‰€æœ‰ç§Ÿæˆ·ï¼ˆåˆ†é¡µã€å¯ç­›é€‰ï¼‰
      description: è·å–å¹³å°æ‰€æœ‰ç§Ÿæˆ·çš„åˆ—è¡¨ï¼Œæ”¯æŒåˆ†é¡µã€çŠ¶æ€ç­›é€‰å’Œå…³é”®è¯æœç´¢ã€‚
      security:
        - AdminSessionAuth: []
      parameters:
        - name: page
          in: query
          description: é¡µç 
          required: false
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          description: æ¯é¡µæ•°é‡
          required: false
          schema:
            type: integer
            default: 10
        - name: status
          in: query
          description: ç­›é€‰ç§Ÿæˆ·çŠ¶æ€
          required: false
          schema:
            type: string
            enum:
              - pending
              - approved
              - rejected
              - active
              - inactive
        - name: search
          in: query
          description: æœç´¢ç§Ÿæˆ·åç§°æˆ–è”ç³»äºº
          required: false
          schema:
            type: string
      responses:
        '200':
          description: ç§Ÿæˆ·åˆ—è¡¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      tenants:
                        type: array
                        items:
                          $ref: '#/components/schemas/TenantListItem'
                      pagination:
                        $ref: '#/components/schemas/PaginationInfo'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /api/admin/tenants/{id}:
    get:
      tags:
        - admin-tenant
      operationId: getTenantById
      summary: è·å–å•ä¸ªç§Ÿæˆ·è¯¦æƒ…
      description: è·å–æŒ‡å®šIDç§Ÿæˆ·çš„å®Œæ•´ä¿¡æ¯ï¼ŒåŒ…æ‹¬åŸºæœ¬ä¿¡æ¯ã€è½¦è¾†ã€è´¢åŠ¡å’Œå®¢æœä¿¡æ¯ã€‚
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: ç§Ÿæˆ·è¯¦æƒ…
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/TenantDetail'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
    put:
      tags:
        - admin-tenant
      operationId: updateTenantBasicInfo
      summary: æ›´æ–°ç§Ÿæˆ·åŸºæœ¬ä¿¡æ¯
      description: æ›´æ–°æŒ‡å®šIDç§Ÿæˆ·çš„åŸºæœ¬ä¿¡æ¯ï¼ˆå¦‚çŠ¶æ€ã€è”ç³»äººç­‰ï¼‰ã€‚
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                contact_person:
                  type: string
                contact_phone:
                  type: string
                email:
                  type: string
                  format: email
                status:
                  type: string
                  enum:
                    - pending
                    - approved
                    - rejected
                    - active
                    - inactive
                address:
                  type: string
      responses:
        '200':
          description: æ›´æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/TenantListItem'
                  message:
                    type: string
        '400':
          $ref: '#/components/responses/ForbiddenError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/admin/reports/overview-stats:
    get:
      tags:
        - admin-reports
      summary: è·å–å¹³å°æ¦‚è§ˆç»Ÿè®¡æ•°æ®
      operationId: getOverviewStats
      security:
        - AdminSessionAuth: []
      responses:
        '200':
          description: å¹³å°æ¦‚è§ˆç»Ÿè®¡æ•°æ®
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      total_orders:
                        type: integer
                        example: 150
                      completed_orders:
                        type: integer
                        example: 120
                      in_transit_orders:
                        type: integer
                        example: 20
                      pending_orders:
                        type: integer
                        example: 5
                      processing_orders:
                        type: integer
                        example: 5
                      cancelled_orders:
                        type: integer
                        example: 0
                      total_customers:
                        type: integer
                        example: 45
                      recent_orders:
                        type: array
                        items:
                          $ref: '#/components/schemas/OrderItem'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /api/admin/tenants/approved:
    get:
      tags:
        - admin-tenant
      operationId: listApprovedTenants
      summary: è·å–å·²æ‰¹å‡†çš„ç§Ÿæˆ·åˆ—è¡¨
      description: è·å–æ‰€æœ‰å·²æ‰¹å‡†çŠ¶æ€çš„ç§Ÿæˆ·åˆ—è¡¨
      security:
        - AdminSessionAuth: []
      parameters:
        - name: page
          in: query
          description: é¡µç 
          required: false
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          description: æ¯é¡µæ•°é‡
          required: false
          schema:
            type: integer
            default: 10
      responses:
        '200':
          description: å·²æ‰¹å‡†ç§Ÿæˆ·åˆ—è¡¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      tenants:
                        type: array
                        items:
                          $ref: '#/components/schemas/TenantListItem'
                      pagination:
                        $ref: '#/components/schemas/PaginationInfo'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /api/admin/tenants/rejected:
    get:
      tags:
        - admin-tenant
      operationId: listRejectedTenants
      summary: è·å–å·²é©³å›çš„ç§Ÿæˆ·åˆ—è¡¨
      description: è·å–æ‰€æœ‰å·²é©³å›çŠ¶æ€çš„ç§Ÿæˆ·åˆ—è¡¨
      security:
        - AdminSessionAuth: []
      parameters:
        - name: page
          in: query
          description: é¡µç 
          required: false
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          description: æ¯é¡µæ•°é‡
          required: false
          schema:
            type: integer
            default: 10
        - name: search
          in: query
          description: æœç´¢å…³é”®è¯ï¼ˆç§Ÿæˆ·åç§°æˆ–è”ç³»æ–¹å¼ï¼‰
          required: false
          schema:
            type: string
      responses:
        '200':
          description: å·²é©³å›ç§Ÿæˆ·åˆ—è¡¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      tenants:
                        type: array
                        items:
                          $ref: '#/components/schemas/TenantListItem'
                      pagination:
                        $ref: '#/components/schemas/PaginationInfo'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /api/admin/tenants/{id}/financial:
    put:
      tags:
        - admin-tenant
      operationId: updateTenantFinancialInfo
      summary: æ›´æ–°ç§Ÿæˆ·è´¢åŠ¡ä¿¡æ¯
      description: æ›´æ–°æŒ‡å®šIDç§Ÿæˆ·çš„è´¢åŠ¡ä¿¡æ¯ã€‚
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TenantFinancialInfo'
      responses:
        '200':
          description: æ›´æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/TenantFinancialInfo'
                  message:
                    type: string
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/admin/tenants/{id}/contact:
    put:
      tags:
        - admin-tenant
      operationId: updateTenantContactInfo
      summary: æ›´æ–°ç§Ÿæˆ·è”ç³»ä¿¡æ¯
      description: æ›´æ–°æŒ‡å®šIDç§Ÿæˆ·çš„è´¢åŠ¡å’Œå®¢æœè”ç³»ä¿¡æ¯ã€‚
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TenantContactInfo'
      responses:
        '200':
          description: æ›´æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/TenantContactInfo'
                  message:
                    type: string
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/admin/vehicles:
    get:
      tags:
        - admin-vehicle
      operationId: listAllVehicles
      summary: è·å–æ‰€æœ‰è½¦è¾†åˆ—è¡¨
      description: è·å–å¹³å°ä¸­æ‰€æœ‰è½¦è¾†çš„ä¿¡æ¯
      security:
        - AdminSessionAuth: []
      parameters:
        - name: page
          in: query
          description: é¡µç 
          required: false
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          description: æ¯é¡µæ•°é‡
          required: false
          schema:
            type: integer
            default: 10
        - name: search
          in: query
          description: æœç´¢å…³é”®è¯ï¼ˆè½¦ç‰Œå·ã€è½¦å‹ç­‰ï¼‰
          required: false
          schema:
            type: string
      responses:
        '200':
          description: è½¦è¾†åˆ—è¡¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      vehicles:
                        type: array
                        items:
                          $ref: '#/components/schemas/VehicleInfo'
                      pagination:
                        $ref: '#/components/schemas/PaginationInfo'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
    post:
      tags:
        - admin-vehicle
      operationId: addTenantVehicle
      summary: æ·»åŠ è½¦è¾†
      description: æ·»åŠ ä¸€è¾†è½¦è¾†ä¿¡æ¯
      security:
        - AdminSessionAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VehicleInfo'
      responses:
        '201':
          description: æ·»åŠ æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/VehicleInfo'
                  message:
                    type: string
        '400':
          $ref: '#/components/responses/ForbiddenError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /api/admin/vehicles/search:
    get:
      tags:
        - admin-vehicle
      operationId: searchVehicles
      summary: æœç´¢è½¦è¾†
      description: æ ¹æ®æ¡ä»¶æœç´¢è½¦è¾†
      security:
        - AdminSessionAuth: []
      parameters:
        - name: plate_number
          in: query
          description: è½¦ç‰Œå·
          required: false
          schema:
            type: string
        - name: type
          in: query
          description: è½¦è¾†ç±»å‹
          required: false
          schema:
            type: string
        - name: status
          in: query
          description: è½¦è¾†çŠ¶æ€
          required: false
          schema:
            type: string
      responses:
        '200':
          description: åŒ¹é…çš„è½¦è¾†åˆ—è¡¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/VehicleInfo'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /api/admin/vehicles/{id}:
    get:
      tags:
        - admin-vehicle
      operationId: getVehicleById
      summary: è·å–æŒ‡å®šè½¦è¾†è¯¦æƒ…
      description: è·å–æŒ‡å®šIDçš„è½¦è¾†è¯¦ç»†ä¿¡æ¯
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: è½¦è¾†è¯¦æƒ…
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/VehicleInfo'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/admin/tenants/{id}/vehicles:
    post:
      tags:
        - admin-tenant
      operationId: addTenantVehicle
      summary: æ·»åŠ ç§Ÿæˆ·è½¦è¾†
      description: ä¸ºæŒ‡å®šIDçš„ç§Ÿæˆ·æ·»åŠ ä¸€è¾†è½¦è¾†ä¿¡æ¯ã€‚
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VehicleInfo'
      responses:
        '201':
          description: æ·»åŠ æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/VehicleInfo'
                  message:
                    type: string
        '400':
          $ref: '#/components/responses/ForbiddenError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/health:
    get:
      summary: å¥åº·æ£€æŸ¥
      operationId: healthCheck
      tags:
        - public
      responses:
        '200':
          description: æœåŠ¡æ­£å¸¸è¿è¡Œ
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: ok
        '500':
          description: æœåŠ¡å†…éƒ¨é”™è¯¯
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /api/customer/order/bind:
    post:
      summary: å°†è®¢å•ç»‘å®šåˆ°å®¢æˆ·ï¼ˆé€šè¿‡æ‰‹æœºå·ï¼‰
      operationId: bindOrderToCustomer
      security:
        - TenantSessionAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                order_id:
                  type: integer
                  example: 123456
              required:
                - order_id
      responses:
        '200':
          description: ç»‘å®šæˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    type: object
        '400':
          description: å‚æ•°é”™è¯¯æˆ–å®¢æˆ·ä¸å­˜åœ¨
        '401':
          description: æœªç™»å½•
        '404':
          description: è®¢å•æœªæ‰¾åˆ°æˆ–å·²ç»‘å®š
  /api/customer/orders:
    post:
      tags:
        - customer-order
      summary: å®¢æˆ·åˆ›å»ºæ–°è®¢å•
      operationId: createCustomerOrder
      security:
        - TenantSessionAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateOrderRequest'
      responses:
        '201':
          description: è®¢å•åˆ›å»ºæˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  order_id:
                    type: string
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
    get:
      tags:
        - customer-order
      summary: è·å–å®¢æˆ·è‡ªå·±çš„è®¢å•åˆ—è¡¨
      operationId: listCustomerOrders
      security:
        - TenantSessionAuth: []
      responses:
        '200':
          description: è®¢å•åˆ—è¡¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderListResponse'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /api/customer/orders/{order_id}:
    get:
      tags:
        - customer-order
      summary: è·å–å•ä¸ªå®¢æˆ·è®¢å•è¯¦æƒ…
      operationId: getCustomerOrder
      security:
        - TenantSessionAuth: []
      parameters:
        - name: order_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: è®¢å•è¯¦æƒ…
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderItem'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
    put:
      tags:
        - customer-order
      summary: æ›´æ–°å®¢æˆ·è®¢å•ï¼ˆå¦‚ä¿®æ”¹åœ°å€ã€å¤‡æ³¨ç­‰ï¼‰
      operationId: updateCustomerOrder
      security:
        - TenantSessionAuth: []
      parameters:
        - name: order_id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                pickup_address:
                  type: string
                delivery_address:
                  type: string
                description:
                  type: string
      responses:
        '200':
          description: æ›´æ–°æˆåŠŸ
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
    delete:
      tags:
        - customer-order
      summary: åˆ é™¤å®¢æˆ·è®¢å•ï¼ˆä»…é™æœªè®¤é¢†çŠ¶æ€ï¼‰
      operationId: deleteCustomerOrder
      security:
        - TenantSessionAuth: []
      parameters:
        - name: order_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: åˆ é™¤æˆåŠŸ
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/customer/orders/{order_id}/quotes:
    get:
      tags:
        - customer-order
      summary: è·å–è®¢å•çš„æŠ¥ä»·åˆ—è¡¨
      operationId: getOrderQuotes
      security:
        - TenantSessionAuth: []
      parameters:
        - name: order_id
          in: path
          required: true
          schema:
            type: string
          description: è®¢å•ID
      responses:
        '200':
          description: æŠ¥ä»·åˆ—è¡¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      order_id:
                        type: string
                        example: order_123
                      quotes:
                        type: array
                        items:
                          type: object
                          properties:
                            carrier:
                              type: object
                              properties:
                                id:
                                  type: integer
                                name:
                                  type: string
                                tenant_name:
                                  type: string
                            price:
                              type: number
                              example: 150
                            delivery_time:
                              type: string
                              format: date-time
                              example: '2026-01-14T18:00:00Z'
                            remarks:
                              type: string
                              example: å¯åŠ æ€¥ï¼Œä½†éœ€é¢å¤–è´¹ç”¨
                            status:
                              type: string
                              example: pending
                            created_at:
                              type: string
                              format: date-time
                              example: '2026-01-13T10:00:00Z'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/setup/status:
    get:
      tags:
        - setup
      summary: æ£€æŸ¥å¹³å°æ˜¯å¦å·²å®Œæˆåˆå§‹åŒ–ï¼ˆæ˜¯å¦å­˜åœ¨ç®¡ç†å‘˜ï¼‰
      operationId: getSetupStatus
      responses:
        '200':
          description: è¿”å›åˆå§‹åŒ–çŠ¶æ€
          content:
            application/json:
              schema:
                type: object
                properties:
                  initialized:
                    type: boolean
                    example: false
        '500':
          description: æœåŠ¡å†…éƒ¨é”™è¯¯
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /api/setup/admin:
    post:
      tags:
        - setup
      summary: åˆ›å»ºé¦–ä¸ªå¹³å°ç®¡ç†å‘˜ï¼ˆä»…é™æœªåˆå§‹åŒ–æ—¶è°ƒç”¨ï¼‰
      operationId: createFirstAdmin
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - username
                - password
                - email
                - platform_name
              properties:
                username:
                  $ref: '#/components/schemas/Username'
                password:
                  type: string
                  minLength: 8
                  example: SecurePass123!
                email:
                  type: string
                  format: email
                  example: admin@yourlogistics.com
                platform_name:
                  type: string
                  description: è¯¥å¹³å°å®ä¾‹çš„åç§°ï¼ˆå¦‚â€œåä¸œç‰©æµäº‘â€ï¼‰
                  example: æˆ‘çš„ç‰©æµå¹³å°
                license_key:
                  type: string
                  description: æˆæƒå¯†é’¥ï¼ˆå¯é€‰ï¼Œç”¨äºäº§å“æˆæƒéªŒè¯ï¼‰
                  example: LIC-2026-XXXX-YYYY-ZZZZ
      responses:
        '201':
          description: åˆå§‹åŒ–æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: å¹³å°åˆå§‹åŒ–æˆåŠŸ
        '400':
          description: è¯·æ±‚å‚æ•°é”™è¯¯
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: å¹³å°å·²åˆå§‹åŒ–ï¼Œç¦æ­¢é‡å¤åˆ›å»º
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /api/auth/ping:
    get:
      summary: æ£€æŸ¥å½“å‰ä¼šè¯æ˜¯å¦æœ‰æ•ˆ
      description: ç”¨äºéªŒè¯ç”¨æˆ·ç™»å½•çŠ¶æ€ï¼ˆSession æ˜¯å¦æœ‰æ•ˆï¼‰ã€‚
      security:
        - TenantSessionAuth: []
      tags:
        - auth
      responses:
        '200':
          description: Session æœ‰æ•ˆ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Session is valid
                  user:
                    type: object
                    properties:
                      id:
                        type: string
                        example: user_123
                      name:
                        type: string
                        example: å¼ ä¸‰
        '401':
          description: Session æ— æ•ˆæˆ–æœªç™»å½•
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Session is invalid or not logged in
  /api/admin/login:
    post:
      tags:
        - admin-auth
      summary: å¹³å°ç®¡ç†å‘˜ç™»å½•
      operationId: adminLogin
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - username
                - password
              properties:
                username:
                  $ref: '#/components/schemas/Username'
                password:
                  type: string
                  example: SecurePass123!
      responses:
        '200':
          description: ç™»å½•æˆåŠŸ,Set-Cookie è‡ªåŠ¨è®¾ç½® session
        '401':
          description: ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /api/admin/logout:
    post:
      tags:
        - admin-auth
      summary: å¹³å°ç®¡ç†å‘˜ç™»å‡º
      operationId: adminLogout
      security:
        - AdminSessionAuth: []
      responses:
        '200':
          description: ç™»å‡ºæˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: å·²å®‰å…¨é€€å‡º
  /api/admin/profile:
    get:
      tags:
        - admin-auth
      summary: è·å–å½“å‰ç®¡ç†å‘˜åŸºæœ¬ä¿¡æ¯
      operationId: getAdminProfile
      security:
        - AdminSessionAuth: []
      responses:
        '200':
          description: ç®¡ç†å‘˜ä¿¡æ¯
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                  username:
                    type: string
                  email:
                    type: string
                  platform_name:
                    type: string
                  created_at:
                    type: string
                    format: date-time
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /api/admin/users:
    post:
      tags:
        - admin-user
      summary: åˆ›å»ºæ–°çš„å¹³å°ç®¡ç†å‘˜ç”¨æˆ·ï¼ˆéœ€å½“å‰ç®¡ç†å‘˜æƒé™ï¼‰
      operationId: createAdminUser
      security:
        - AdminSessionAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - username
                - password
                - email
              properties:
                username:
                  $ref: '#/components/schemas/Username'
                password:
                  type: string
                  minLength: 8
                email:
                  type: string
                  format: email
                role:
                  type: string
                  enum:
                    - admin
                    - operator
                  default: admin
      responses:
        '201':
          description: ç®¡ç†å‘˜åˆ›å»ºæˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        '409':
          description: ç”¨æˆ·åæˆ–é‚®ç®±å·²å­˜åœ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /api/admin/tenants/pending:
    get:
      tags:
        - admin-tenant
      operationId: listPendingTenants
      security:
        - AdminSessionAuth: []
      responses:
        '200':
          description: å¾…å®¡æ ¸ç§Ÿæˆ·åˆ—è¡¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/TenantApplication'
  /api/admin/tenants/{id}/approve:
    put:
      tags:
        - admin-tenant
      summary: æ‰¹å‡†ç§Ÿæˆ·ç”³è¯·
      operationId: approveTenant
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                roles:
                  type: array
                  items:
                    type: string
                    enum:
                      - customer
                      - carrier
      responses:
        '200':
          description: å®¡æ ¸é€šè¿‡
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/admin/tenants/{id}/reject:
    put:
      tags:
        - admin-tenant
      summary: æ‹’ç»ç§Ÿæˆ·ç”³è¯·
      operationId: rejectTenant
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                notes:
                  type: string
                  description: æ‹’ç»åŸå› ï¼ˆå¯é€‰ï¼‰
      responses:
        '200':
          description: æ‹’ç»æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: ç§Ÿæˆ·ç”³è¯·å·²æ‹’ç»
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/admin/orders:
    get:
      tags:
        - admin-order
      operationId: listAdminOrders
      security:
        - AdminSessionAuth: []
      responses:
        '200':
          description: æ‰€æœ‰è®¢å•åˆ—è¡¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderListResponse'
  /api/admin/orders/{id}/status:
    put:
      tags:
        - admin-order
      summary: æ€»åå°è°ƒåº¦è®¢å•
      operationId: updateOrderStatus
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - status
              properties:
                status:
                  type: string
                  enum:
                    - pending
                    - pending_claim
                    - available
                    - created
                    - claimed
                    - awarded
                    - dispatched
                    - in_transit
                    - delivered
                    - cancelled
                  example: cancelled
      responses:
        '200':
          description: çŠ¶æ€æ›´æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: è®¢å•çŠ¶æ€å·²æ›´æ–°
        '400':
          description: çŠ¶æ€å€¼æ— æ•ˆ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/public/orders/{id}:
    get:
      operationId: fetchPublicOrder
      summary: è·å–å…¬å¼€è®¢å•è¯¦æƒ…
      description: é€šè¿‡è¿½è¸ªå·è·å–è®¢å•çš„å…¬å¼€ä¿¡æ¯ã€‚
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: è®¢å•çš„è¿½è¸ªå· (tracking_number)
      responses:
        '200':
          description: è®¢å•ä¿¡æ¯è·å–æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  order:
                    $ref: '#/components/schemas/OrderItem'
        '404':
          description: è®¢å•æœªæ‰¾åˆ°
        '500':
          description: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯.
  /api/public/orders:
    post:
      tags:
        - public
      summary: å°ç¨‹åºåˆ›å»ºè®¢å•ï¼ˆä¸´æ—¶ï¼‰
      operationId: createPublicOrder
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateOrderRequest'
      responses:
        '201':
          description: è®¢å•åˆ›å»ºæˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  order_id:
                    type: string
        '400':
          $ref: '#/components/responses/ForbiddenError'
  /api/carrier/orders:
    get:
      tags:
        - carrier-order
      summary: è·å–å¯è®¤é¢†çš„è®¢å•åˆ—è¡¨ï¼ˆçŠ¶æ€=pending_claim)
      operationId: listCarrierOrders
      security:
        - TenantSessionAuth: []
      parameters:
        - name: page
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
          description: é¡µç 
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
          description: æ¯é¡µè®°å½•æ•°
        - name: status
          in: query
          required: false
          schema:
            type: string
          description: è®¢å•çŠ¶æ€ç­›é€‰
        - name: search
          in: query
          required: false
          schema:
            type: string
          description: æœç´¢å…³é”®è¯
      responses:
        '200':
          description: å¯è®¤é¢†è®¢å•åˆ—è¡¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderListResponse'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /api/carrier/orders/{order_id}/claim:
    put:
      tags:
        - carrier-order
      summary: æ‰¿è¿å•†è®¤é¢†è®¢å•
      operationId: claimCarrierOrder
      security:
        - TenantSessionAuth: []
      parameters:
        - name: order_id
          in: path
          required: true
          schema:
            type: integer
          description: è®¢å•å”¯ä¸€æ ‡è¯†ï¼ˆå¦‚ tracking_number æˆ–ç³»ç»Ÿ IDï¼‰
      responses:
        '200':
          description: è®¤é¢†æˆåŠŸï¼Œè¿”å›æ›´æ–°åçš„å®Œæ•´è®¢å•ä¿¡æ¯
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderItem'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/carrier/orders/{order_id}/complete:
    put:
      tags:
        - carrier-order
      summary: æ‰¿è¿æ–¹å®Œæˆè®¢å•
      operationId: completeCarrierOrder
      security:
        - TenantSessionAuth: []
      parameters:
        - name: order_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: å®ŒæˆæˆåŠŸ
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/carrier/orders/{order_id}/start-delivery:
    put:
      tags:
        - carrier-order
      summary: æ‰¿è¿æ–¹å¼€å§‹é…é€è®¢å•
      operationId: startDelivery
      security:
        - TenantSessionAuth: []
      parameters:
        - name: order_id
          in: path
          required: true
          schema:
            type: string
          description: è®¢å•ID
      responses:
        '200':
          description: å¼€å§‹é…é€æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Delivery started successfully
                  data:
                    type: object
                    properties:
                      order_id:
                        type: string
                        example: order_123
                      status:
                        type: string
                        example: in_transit
        '400':
          description: è®¢å•çŠ¶æ€ä¸å…è®¸å¼€å§‹é…é€
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/carrier/orders/{order_id}/quote:
    post:
      operationId: submitCarrierQuote
      summary: æ‰¿è¿å•†ä¸ºæŒ‡å®šè®¢å•æäº¤æŠ¥ä»·
      description: |
        æ‰¿è¿å•†æäº¤ä¸€ä¸ªæŠ¥ä»·ï¼ˆä»·æ ¼ã€é¢„è®¡é€è¾¾æ—¶é—´ã€å¤‡æ³¨ï¼‰ç»™æŒ‡å®šçš„è®¢å•ã€‚
        æ­¤æ“ä½œä¸ä¼šæ”¹å˜è®¢å•çš„ä¸»çŠ¶æ€(status)æŠ¥ä»·ä¿¡æ¯å°†å­˜å‚¨åœ¨ quotes è¡¨ä¸­ã€‚
        è®¢å•çŠ¶æ€çš„å˜æ›´å°†åœ¨åç»­çš„å®¢æˆ·é€‰æ‹©æˆ–å¹³å°æŒ‡æ´¾ç¯èŠ‚å‘ç”Ÿã€‚
      tags:
        - Carrier
        - Quote
      security:
        - TenantSessionAuth: []
      parameters:
        - name: order_id
          in: path
          required: true
          schema:
            type: integer
          description: è¦æŠ¥ä»·çš„è®¢å•ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                price:
                  type: number
                  format: float
                  minimum: 0.01
                  description: æŠ¥ä»·é‡‘é¢
                  example: 150.75
                deliveryTime:
                  type: string
                  description: é¢„è®¡é€è¾¾æ—¶é—´ (ISO 8601 æ ¼å¼æˆ–è‡ªå®šä¹‰æ ¼å¼)
                  example: '2024-05-25T18:00:00Z'
                remarks:
                  type: string
                  maxLength: 500
                  description: æŠ¥ä»·å¤‡æ³¨
                  example: å¯åŠ æ€¥ï¼Œä½†éœ€é¢å¤–è´¹ç”¨
              required:
                - price
                - deliveryTime
      responses:
        '201':
          description: æŠ¥ä»·æäº¤æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Quote submitted successfully
                  data:
                    type: object
                    properties:
                      order_id:
                        type: integer
                        example: 123
                      quote:
                        type: object
                        properties:
                          price:
                            type: number
                            format: float
                            example: 150.75
                          deliveryTime:
                            type: string
                            example: '2024-05-25T18:00:00Z'
                          remarks:
                            type: string
                            example: å¯åŠ æ€¥ï¼Œä½†éœ€é¢å¤–è´¹ç”¨
                      carrierId:
                        type: integer
                        example: 456
        '400':
          description: è¯·æ±‚å‚æ•°é”™è¯¯
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          description: è®¢å•æœªæ‰¾åˆ°æˆ–ä¸å…è®¸æŠ¥ä»·
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: æ‰¿è¿å•†å·²ä¸ºæ­¤è®¢å•æäº¤è¿‡æŠ¥ä»·
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/customer/orders/{order_id}/award:
    post:
      tags:
        - customer-order
      summary: å®¢æˆ·é€‰æ‹©æ‰¿è¿æ–¹ï¼ˆæˆäº¤ï¼‰
      operationId: awardOrderToCarrier
      security:
        - TenantSessionAuth: []
      parameters:
        - name: order_id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                carrier_tenant_id:
                  type: string
                  description: è¢«é€‰ä¸­çš„æ‰¿è¿æ–¹ç§Ÿæˆ·ID
              required:
                - carrier_tenant_id
      responses:
        '200':
          description: è®¢å•å·²åˆ†é…ç»™æ‰¿è¿æ–¹
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: è®¢å•å·²æˆäº¤ï¼Œæ‰¿è¿æ–¹å·²é€šçŸ¥
        '400':
          description: è¯·æ±‚å‚æ•°é”™è¯¯ï¼ˆå¦‚ carrier_tenant_id æ— æ•ˆï¼‰
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/tenant-web/register:
    post:
      tags:
        - auth
      summary: ç§Ÿæˆ·/å®¢æˆ·æ³¨å†Œ
      operationId: registerTenantWeb
      description: æ–°ç§Ÿæˆ·æˆ–å®¢æˆ·æäº¤æ³¨å†Œä¿¡æ¯ï¼Œåˆ›å»ºè´¦æˆ·ã€‚
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CustomerWebRegistration'
      responses:
        '201':
          description: æ³¨å†ŒæˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Tenant registered successfully
                  data:
                    type: object
                    description: å¯é€‰ï¼šè¿”å›æ–°åˆ›å»ºçš„ç§Ÿæˆ·ä¿¡æ¯æˆ–ç™»å½•å‡­æ®
                    properties:
                      tenant_id:
                        type: string
                        example: tenant_abc123
        '400':
          description: è¯·æ±‚å‚æ•°ä¸å®Œæ•´æˆ–æ ¼å¼é”™è¯¯
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: é‚®ç®±æˆ–æ‰‹æœºå·å·²å­˜åœ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /api/tenant-web/login:
    post:
      tags:
        - auth
      summary: ç§Ÿæˆ·ç™»å½•/å®¢æˆ·ç™»å½•
      operationId: loginTenantWeb
      description: |
        ç§Ÿæˆ·æˆ–å®¢æˆ·ä½¿ç”¨é‚®ç®±æˆ–æ‰‹æœºå·ç™»å½•ã€‚
        - è¯·æ±‚ä½“å¿…é¡»åŒ…å« `email` æˆ– `phone` ä¸­çš„ **ä»»æ„ä¸€ä¸ª**ï¼Œä»¥åŠ `password`ã€‚
        - ç¤ºä¾‹ 1: { "email": "user@example.com", "password": "..." }
        - ç¤ºä¾‹ 2: { "phone": "13800138000", "password": "..." }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  format: email
                  description: ç§Ÿæˆ·/å®¢æˆ·æ³¨å†Œé‚®ç®±
                  example: user@example.com
                phone:
                  type: string
                  pattern: ^1[3-9][0-9]{9}$
                  description: ç§Ÿæˆ·/å®¢æˆ·æ³¨å†Œæ‰‹æœºå·
                  example: '13800138000'
                password:
                  type: string
                  description: ç™»å½•å¯†ç 
                  example: SecurePassword123!
              required:
                - password
      responses:
        '200':
          description: ç™»å½•æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Login successful
                  data:
                    type: object
                    properties:
                      tenant_id:
                        type: string
                        example: tenant_12345
                      name:
                        type: string
                        example: Example Tenant
                      roles:
                        type: array
                        items:
                          type: string
                          enum:
                            - customer
                            - carrier
                        example:
                          - customer
                    required:
                      - tenant_id
                      - name
                      - roles
        '400':
          description: è¯·æ±‚å‚æ•°é”™è¯¯ (ç¼ºå°‘ email æˆ– phoneï¼Œæˆ–æ ¼å¼é”™è¯¯)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: Either email or phone must be provided along with password.
        '401':
          description: é‚®ç®±æˆ–å¯†ç é”™è¯¯ / æ‰‹æœºå·æˆ–å¯†ç é”™è¯¯ / è´¦æˆ·æœªæ¿€æ´»
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: Invalid credentials
  /api/tenant-web/profile:
    get:
      tags:
        - auth
      summary: è·å–ç§Ÿæˆ·åŸºæœ¬ä¿¡æ¯
      operationId: getTenantProfile
      security:
        - TenantSessionAuth: []
      responses:
        '200':
          description: ç§Ÿæˆ·ä¿¡æ¯
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TenantProfile'
    put:
      tags:
        - auth
      summary: æ›´æ–°ç§Ÿæˆ·åŸºæœ¬ä¿¡æ¯
      operationId: updateTenantProfile
      security:
        - TenantSessionAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                contact_person:
                  type: string
                contact_phone:
                  type: string
                address:
                  type: string
      responses:
        '200':
          description: ä¿¡æ¯æ›´æ–°æˆåŠŸ
        '401':
          $ref: '#/components/responses/UnauthorizedError'
    post:
      tags:
        - auth
      summary: ç§Ÿæˆ·åˆ›å»ºæ–°è®¢å•
      operationId: createTenantOrder
      security:
        - TenantSessionAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - customer_name
                - customer_phone
                - address
                - weight
              properties:
                customer_name:
                  type: string
                customer_phone:
                  type: string
                  pattern: ^1[3-9][0-9]{9}$
                address:
                  type: string
                weight:
                  type: number
                  minimum: 0.1
      responses:
        '201':
          description: è®¢å•åˆ›å»ºæˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  order_id:
                    type: string
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /api/tenant-web/profile/roles:
    get:
      tags:
        - auth
      summary: è·å–ç§Ÿæˆ·å¯ç”¨çš„è§’è‰²åˆ—è¡¨
      operationId: getTenantRoles
      security:
        - TenantSessionAuth: []
      responses:
        '200':
          description: è§’è‰²åˆ—è¡¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: string
                      enum:
                        - customer
                        - carrier
  /api/pc-tenant/apply:
    post:
      operationId: applyPcTenant
      summary: ç§Ÿæˆ·å…¥é©»ç”³è¯·
      description: æ–°ç§Ÿæˆ·æäº¤å…¥é©»ç”³è¯·ï¼Œåˆ›å»ºæ–°ç§Ÿæˆ·è´¦æˆ·
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
                - contact_person
                - contact_phone
                - email
                - password
                - roles
              properties:
                name:
                  type: string
                  description: å…¬å¸åç§°
                contact_person:
                  type: string
                  description: è”ç³»äººå§“å
                contact_phone:
                  type: string
                  description: è”ç³»ç”µè¯
                email:
                  type: string
                  description: é‚®ç®±åœ°å€
                password:
                  type: string
                  minLength: 6
                  description: å¯†ç ï¼ˆè‡³å°‘6ä½ï¼‰
                roles:
                  type: array
                  items:
                    type: string
                    enum:
                      - customer
                      - carrier
                  description: è§’è‰²åˆ—è¡¨
                address:
                  type: string
                  description: å…¬å¸åœ°å€
      responses:
        '201':
          description: ç§Ÿæˆ·åˆ›å»ºæˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    description: ç§Ÿæˆ·ID
                  name:
                    type: string
                  contact_person:
                    type: string
                  contact_phone:
                    type: string
                  email:
                    type: string
                  roles:
                    type: array
                    items:
                      type: string
                  address:
                    type: string
                  created_at:
                    type: string
                    format: date-time
        '400':
          description: è¯·æ±‚å‚æ•°ä¸å®Œæ•´æˆ–æ ¼å¼é”™è¯¯
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: MISSING_REQUIRED_FIELDS
        '409':
          description: é‚®ç®±å·²å­˜åœ¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: EMAIL_ALREADY_REGISTERED
        '500':
          description: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯
  /api/tenant-web/orders/pending:
    get:
      tags:
        - auth
      summary: è·å–å¯è®¤é¢†çš„è®¢å•åˆ—è¡¨ï¼ˆçŠ¶æ€=createdï¼‰
      operationId: listPendingOrders
      security:
        - TenantSessionAuth: []
      responses:
        '200':
          description: å¯è®¤é¢†è®¢å•åˆ—è¡¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderListResponse'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /api/tenant-web/orders/{order_id}/claim:
    put:
      tags:
        - auth
      summary: ç§Ÿæˆ·è®¤é¢†è®¢å•
      operationId: claimOrder
      security:
        - TenantSessionAuth: []
      parameters:
        - name: order_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: è®¤é¢†æˆåŠŸ
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/tenant-web/orders/{order_id}/complete:
    put:
      tags:
        - auth
      summary: ç§Ÿæˆ·å®Œæˆè®¢å•
      operationId: completeOrder
      security:
        - TenantSessionAuth: []
      parameters:
        - name: order_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: å®ŒæˆæˆåŠŸ
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/tenant-web/logout:
    post:
      tags:
        - auth
      summary: ç§Ÿæˆ·ç™»å‡º
      operationId: logoutTenant
      security:
        - TenantSessionAuth: []
      responses:
        '200':
          description: ç™»å‡ºæˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: å·²å®‰å…¨é€€å‡º
  /api/matching/search-carriers:
    post:
      tags:
        - matching
      summary: æ ¹æ®è®¢å•éœ€æ±‚æœç´¢åŒ¹é…çš„æ‰¿è¿æ–¹
      operationId: searchMatchingCarriers
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - pickup_address
                - delivery_address
                - weight_kg
              properties:
                pickup_address:
                  type: string
                  example: åŒ—äº¬å¸‚æœé˜³åŒºXXå¤§å¦
                delivery_address:
                  type: string
                  example: ä¸Šæµ·å¸‚æµ¦ä¸œæ–°åŒºYYå›­åŒº
                weight_kg:
                  type: number
                  format: float
                  minimum: 0.1
                  example: 25.5
                volume_m3:
                  type: number
                  minimum: 0.01
                  example: 1.2
                required_delivery_time:
                  type: string
                  format: date-time
                  example: '2026-01-15T12:00:00Z'
                preferred_carrier_ids:
                  type: array
                  items:
                    type: string
                  description: ä¼˜å…ˆåŒ¹é…çš„æ‰¿è¿æ–¹IDåˆ—è¡¨
      responses:
        '200':
          description: åŒ¹é…çš„æ‰¿è¿æ–¹åˆ—è¡¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/QuoteItem'
        '400':
          $ref: '#/components/responses/ForbiddenError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /api/matching/get-quote-suggestions:
    get:
      tags:
        - matching
      summary: è·å–é’ˆå¯¹ç‰¹å®šè®¢å•çš„é¢„ä¼°æŠ¥ä»·å»ºè®®
      operationId: getQuoteSuggestions
      parameters:
        - name: order_id
          in: path
          required: true
          schema:
            type: string
          description: è®¢å•ID
      responses:
        '200':
          description: é¢„ä¼°æŠ¥ä»·å»ºè®®åˆ—è¡¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/QuoteItem'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/carrier/quotes:
    get:
      tags:
        - carrier-order
      summary: è·å–æ‰¿è¿å•†çš„æ‰€æœ‰æŠ¥ä»·åˆ—è¡¨
      operationId: listCarrierQuotes
      security:
        - TenantSessionAuth: []
      parameters:
        - name: page
          in: query
          description: é¡µç 
          required: false
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          description: æ¯é¡µæ•°é‡
          required: false
          schema:
            type: integer
            default: 10
        - name: order_id
          in: query
          description: è®¢å•IDè¿‡æ»¤
          required: false
          schema:
            type: string
        - name: status
          in: query
          description: æŠ¥ä»·çŠ¶æ€è¿‡æ»¤
          required: false
          schema:
            type: string
            enum:
              - pending
              - awarded
              - rejected
              - expired
      responses:
        '200':
          description: æ‰¿è¿å•†æŠ¥ä»·åˆ—è¡¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: è·å–æˆåŠŸ
                  data:
                    type: object
                    properties:
                      quotes:
                        type: array
                        items:
                          $ref: '#/components/schemas/QuoteItem'
                      pagination:
                        $ref: '#/components/schemas/PaginationInfo'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /api/admin/pricing-rules:
    get:
      tags:
        - admin-pricing
      summary: è·å–å¹³å°å®šä»·è§„åˆ™åˆ—è¡¨
      operationId: listPlatformPricingRules
      security:
        - AdminSessionAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            default: 1
          description: é¡µç 
        - name: limit
          in: query
          schema:
            type: integer
            default: 10
          description: æ¯é¡µæ•°é‡
        - name: active
          in: query
          schema:
            type: boolean
          description: æ˜¯å¦åªè¿”å›æ¿€æ´»çš„è§„åˆ™
      responses:
        '200':
          description: å®šä»·è§„åˆ™åˆ—è¡¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/PricingRule'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
    post:
      tags:
        - admin-pricing
      summary: åˆ›å»ºå¹³å°å®šä»·è§„åˆ™
      operationId: createPlatformPricingRule
      security:
        - AdminSessionAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreatePricingRuleRequest'
      responses:
        '201':
          description: å®šä»·è§„åˆ™åˆ›å»ºæˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: å¹³å°å®šä»·è§„åˆ™åˆ›å»ºæˆåŠŸ
                  data:
                    $ref: '#/components/schemas/PricingRule'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/admin/pricing-rules/{id}:
    get:
      tags:
        - admin-pricing
      summary: è·å–å•ä¸ªå¹³å°å®šä»·è§„åˆ™
      operationId: getPlatformPricingRule
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: å®šä»·è§„åˆ™ID
      responses:
        '200':
          description: å®šä»·è§„åˆ™è¯¦æƒ…
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/PricingRule'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
    put:
      tags:
        - admin-pricing
      summary: æ›´æ–°å¹³å°å®šä»·è§„åˆ™
      operationId: updatePlatformPricingRule
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: å®šä»·è§„åˆ™ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdatePricingRuleRequest'
      responses:
        '200':
          description: å®šä»·è§„åˆ™æ›´æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: å¹³å°å®šä»·è§„åˆ™æ›´æ–°æˆåŠŸ
                  data:
                    $ref: '#/components/schemas/PricingRule'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - admin-pricing
      summary: åˆ é™¤å¹³å°å®šä»·è§„åˆ™
      operationId: deletePlatformPricingRule
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: å®šä»·è§„åˆ™ID
      responses:
        '200':
          description: å®šä»·è§„åˆ™åˆ é™¤æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: å¹³å°å®šä»·è§„åˆ™åˆ é™¤æˆåŠŸ
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/carrier/pricing-configs:
    get:
      tags:
        - carrier-pricing
      summary: è·å–æ‰¿è¿å•†å®šä»·é…ç½®åˆ—è¡¨
      operationId: listCarrierPricingConfigs
      security:
        - AdminSessionAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            default: 1
          description: é¡µç 
        - name: limit
          in: query
          schema:
            type: integer
            default: 10
          description: æ¯é¡µæ•°é‡
        - name: carrier_id
          in: query
          schema:
            type: integer
          description: æ‰¿è¿å•†IDè¿‡æ»¤
      responses:
        '200':
          description: æ‰¿è¿å•†å®šä»·é…ç½®åˆ—è¡¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/CarrierPricingConfig'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
    post:
      tags:
        - carrier-pricing
      summary: åˆ›å»ºæ‰¿è¿å•†å®šä»·é…ç½®
      operationId: createCarrierPricingConfig
      security:
        - AdminSessionAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateCarrierPricingConfigRequest'
      responses:
        '201':
          description: æ‰¿è¿å•†å®šä»·é…ç½®åˆ›å»ºæˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: æ‰¿è¿å•†å®šä»·é…ç½®åˆ›å»ºæˆåŠŸ
                  data:
                    $ref: '#/components/schemas/CarrierPricingConfig'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/carrier/pricing-configs/{id}:
    get:
      tags:
        - carrier-pricing
      summary: è·å–å•ä¸ªæ‰¿è¿å•†å®šä»·é…ç½®
      operationId: getCarrierPricingConfig
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: å®šä»·é…ç½®ID
      responses:
        '200':
          description: æ‰¿è¿å•†å®šä»·é…ç½®è¯¦æƒ…
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/CarrierPricingConfig'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
    put:
      tags:
        - carrier-pricing
      summary: æ›´æ–°æ‰¿è¿å•†å®šä»·é…ç½®
      operationId: updateCarrierPricingConfig
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: å®šä»·é…ç½®ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateCarrierPricingConfigRequest'
      responses:
        '200':
          description: æ‰¿è¿å•†å®šä»·é…ç½®æ›´æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: æ‰¿è¿å•†å®šä»·é…ç½®æ›´æ–°æˆåŠŸ
                  data:
                    $ref: '#/components/schemas/CarrierPricingConfig'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - carrier-pricing
      summary: åˆ é™¤æ‰¿è¿å•†å®šä»·é…ç½®
      operationId: deleteCarrierPricingConfig
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: å®šä»·é…ç½®ID
      responses:
        '200':
          description: æ‰¿è¿å•†å®šä»·é…ç½®åˆ é™¤æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: æ‰¿è¿å•†å®šä»·é…ç½®åˆ é™¤æˆåŠŸ
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/order/quote:
    post:
      tags:
        - public
      summary: è·å–è®¢å•æŠ¥ä»· - å®¢æˆ·ä¸‹å•æ—¶è·å–å¤šå®¶æ‰¿è¿å•†æŠ¥ä»·
      operationId: getOrderQuote
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - distance_km
                - duration_hours
              properties:
                distance_km:
                  type: number
                  example: 15.5
                  description: è¿è¾“è·ç¦»ï¼ˆå…¬é‡Œï¼‰
                duration_hours:
                  type: number
                  example: 2.5
                  description: é¢„è®¡è¿è¾“æ—¶é•¿ï¼ˆå°æ—¶ï¼‰
                weight_kg:
                  type: number
                  example: 100
                  description: è´§ç‰©é‡é‡ï¼ˆå…¬æ–¤ï¼‰
                is_cold_storage:
                  type: boolean
                  example: false
                  description: æ˜¯å¦éœ€è¦å†·é“¾è¿è¾“
                time_slot:
                  type: string
                  example: morning
                  description: æ—¶é—´æ®µï¼ˆmorning, afternoon, evening, nightï¼‰
                weather_condition:
                  type: string
                  example: normal
                  enum:
                    - normal
                    - rain
                    - snow
                    - storm
                  description: å¤©æ°”çŠ¶å†µ
                region:
                  type: string
                  example: beijing_haidian
                  description: è¿è¾“åŒºåŸŸ
                vehicle_type:
                  type: string
                  example: van
                  enum:
                    - van
                    - truck
                    - refrigerated_truck
                    - container_truck
                  description: æ‰€éœ€è½¦å‹
                pickup_address:
                  type: string
                  example: åŒ—äº¬å¸‚æµ·æ·€åŒºä¸­å…³æ‘å¤§è¡—1å·
                  description: æè´§åœ°å€
                delivery_address:
                  type: string
                  example: åŒ—äº¬å¸‚æœé˜³åŒºå›½è´¸å¤§å¦
                  description: é€è´§åœ°å€
                cargo_type:
                  type: string
                  example: electronics
                  enum:
                    - electronics
                    - clothing
                    - food
                    - medicine
                    - documents
                    - other
                  description: è´§ç‰©ç±»å‹
      responses:
        '200':
          description: æŠ¥ä»·è®¡ç®—æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: æŠ¥ä»·è®¡ç®—æˆåŠŸ
                  data:
                    type: object
                    properties:
                      order_details:
                        $ref: '#/components/schemas/OrderDetails'
                      quotes:
                        type: array
                        items:
                          $ref: '#/components/schemas/CarrierQuote'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/order/{id}/add-ons:
    post:
      tags:
        - carrier-order
      summary: ä¸ºè®¢å•æ·»åŠ é™„åŠ è´¹ - æ‰¿è¿å•†æäº¤é™„åŠ æœåŠ¡è´¹ç”¨
      operationId: addOrderAddons
      security:
        - TenantSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: è®¢å•ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - addons_config
                - addons_total
              properties:
                addons_config:
                  type: object
                  description: é™„åŠ æœåŠ¡é…ç½®
                  properties:
                    loading_fee:
                      type: number
                      example: 50
                      description: è£…å¸è´¹
                    waiting_fee:
                      type: number
                      example: 30
                      description: ç­‰å¾…è´¹
                    overtime_fee:
                      type: number
                      example: 100
                      description: è¶…æ—¶è´¹
                    special_handling_fee:
                      type: number
                      example: 80
                      description: ç‰¹æ®Šå¤„ç†è´¹
                    cold_storage_fee:
                      type: number
                      example: 40
                      description: å†·è—é™„åŠ è´¹
                    insurance_fee:
                      type: number
                      example: 20
                      description: ä¿é™©è´¹
                    other_fees:
                      type: array
                      items:
                        type: object
                        properties:
                          name:
                            type: string
                            example: å¤œé—´é…é€è´¹
                          amount:
                            type: number
                            example: 60
                          description:
                            type: string
                            example: å¤œé—´é…é€é¢å¤–è´¹ç”¨
                addons_total:
                  type: number
                  example: 230
                  description: é™„åŠ è´¹æ€»è®¡
                description:
                  type: string
                  example: å› å®¢æˆ·è¦æ±‚å¤œé—´é…é€å’Œç‰¹æ®ŠåŒ…è£…äº§ç”Ÿçš„é™„åŠ è´¹ç”¨
                  description: é™„åŠ è´¹è¯´æ˜
      responses:
        '200':
          description: é™„åŠ è´¹æ·»åŠ æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: è®¢å•é™„åŠ è´¹æ·»åŠ æˆåŠŸ
                  data:
                    type: object
                    properties:
                      order_id:
                        type: integer
                        example: 1
                      tracking_number:
                        type: string
                        example: ORD-20260209-001
                      addons_config:
                        $ref: '#/components/schemas/AddonsConfig'
                      addons_total:
                        type: number
                        example: 230
                      addons_status:
                        type: string
                        example: pending
                        enum:
                          - pending
                          - confirmed
                          - rejected
                      updated_at:
                        type: string
                        format: date-time
                        example: '2026-02-09T12:00:00Z'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/order/{id}/add-ons/confirm:
    patch:
      tags:
        - customer-order
      summary: ç¡®è®¤è®¢å•é™„åŠ è´¹ - å®¢æˆ·ç¡®è®¤æˆ–æ‹’ç»æ‰¿è¿å•†æäº¤çš„é™„åŠ è´¹
      operationId: confirmOrderAddons
      security:
        - TenantSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: è®¢å•ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - confirm
              properties:
                confirm:
                  type: boolean
                  example: true
                  description: æ˜¯å¦ç¡®è®¤é™„åŠ è´¹ (true=ç¡®è®¤, false=æ‹’ç»)
      responses:
        '200':
          description: é™„åŠ è´¹ç¡®è®¤çŠ¶æ€æ›´æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: è®¢å•é™„åŠ è´¹å·²ç¡®è®¤
                  data:
                    type: object
                    properties:
                      order_id:
                        type: integer
                        example: 1
                      tracking_number:
                        type: string
                        example: ORD-20260209-001
                      addons_total:
                        type: number
                        example: 230
                      addons_status:
                        type: string
                        example: confirmed
                        enum:
                          - pending
                          - confirmed
                          - rejected
                      addons_confirmation_time:
                        type: string
                        format: date-time
                        example: '2026-02-09T12:00:00Z'
                      total_price_with_addons:
                        type: number
                        example: 530
                      updated_at:
                        type: string
                        format: date-time
                        example: '2026-02-09T12:00:00Z'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'
