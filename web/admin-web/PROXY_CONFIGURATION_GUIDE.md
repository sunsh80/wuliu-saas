# 物流管理系统 - 前后端连接配置说明

## 配置概述
本文档说明如何正确配置前端开发服务器代理，以确保API请求能够正确转发到后端服务器。

## 代理配置

### Vite 配置 (vite.config.js)
```javascript
proxy: {
  '/api': {
    target: 'http://192.168.2.250:3000',  // 后端服务器地址
    changeOrigin: true,                   // 改变源地址
    secure: false,                        // 不验证SSL证书
    rewrite: (path) => path.replace(/^\/api/, '/api')  // 路径重写
  }
}
```

### 前端请求路径
- 所有API请求使用相对路径，如: `/api/admin/login`
- 请求将通过代理自动转发到后端服务器

## 文件配置更新

### 1. API基础URL
- 文件: `public/js/api.js`
- 旧值: `http://192.168.2.250:3000/api`
- 新值: `/api` (相对路径)

### 2. 主要API请求函数
- 文件: `public/js/main.js`
- 使用相对路径，通过代理转发

### 3. 登录页面
- 文件: `public/login.html`
- 使用相对路径 `/api/admin/login`

### 4. 认证页面
- 文件: `public/js/auth.js`
- 使用相对路径 `/api/admin/login`

## 工作原理

1. 前端发起请求到 `/api/...`
2. Vite开发服务器捕获请求
3. 通过代理将请求转发到 `http://192.168.2.250:3000/api/...`
4. 后端处理请求并返回响应
5. 响应通过代理返回给前端

## 部署注意事项

### 开发环境
- 确保后端服务运行在 `http://192.168.2.250:3000`
- 启动前端开发服务器: `npm run dev`

### 生产环境
- 需要配置Web服务器将 `/api` 请求代理到后端服务
- 可能需要使用绝对URL而非相对路径

## 故障排除

### 问题: 请求被当作本地文件处理
**原因**: 代理配置未生效
**解决方案**: 
1. 确认Vite开发服务器正在运行
2. 检查代理配置是否正确
3. 重启Vite服务器

### 问题: CORS错误
**原因**: 后端未配置CORS
**解决方案**: 
1. 在后端配置CORS允许前端域名
2. 确保后端接受来自 `http://localhost:5173` 的请求

### 问题: 连接被拒绝
**原因**: 后端服务未运行或网络不通
**解决方案**: 
1. 确认后端服务正在运行
2. 检查网络连通性
3. 验证IP地址和端口是否正确

## 测试步骤

1. 启动后端服务在 `http://192.168.2.250:3000`
2. 启动前端开发服务器: `npm run dev`
3. 访问 `http://localhost:5173`
4. 测试登录功能
5. 检查浏览器控制台是否有错误

## 验证方法

在浏览器开发者工具的Network标签中，应该能看到：
- 请求URL显示为 `http://localhost:5173/api/...`
- 实际发送到后端的URL为 `http://192.168.2.250:3000/api/...`
- 响应状态码为200或其他期望值