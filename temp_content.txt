﻿openapi: 3.0.3
info:
  title: 澶氱鎴风墿娴佸钩锟?API
  version: 1.0.2-safe 鎶€鏈爤:Node.js + Express + SQLite + OpenAPI Backend 璁よ瘉鏈哄埗:express-session(鍩轰簬 Cookie 鐨勪細璇濓級 瀹夊叏妯″瀷锛氶€氳繃 TenantSessionAuth 瀹夊叏澶勭悊鍣ㄦ牎锟?req.session.userId 澶氱鎴锋敮锟?tenants 琛ㄥ瓨鍌ㄧ锟?users 琛ㄥ瓨鍌ㄧ鎴峰憳锟?& 灏忕▼搴忛【锟?
  description: |
    鏀寔瀹㈡埛锛堜笅鍗曟柟锛変笌鎵胯繍鏂癸紙鎺ュ崟鏂癸級鍙岃鑹茬殑鐗╂祦璁㈠崟绯荤粺锟?
    - `/api/admin/...`锛氬钩鍙扮鐞嗗憳
    - `/api/customer/...`锛氬鎴风锟?
    - `/api/carrier/...`锛氭壙杩愭柟绉熸埛
    - `/api/public/...`锛氬叕鍏辨帴锟?
    馃敼 鏈澧炲(v1.0.2-safe):
    - 淇濈暀鎵€锟?v1.0.1 瀛楁銆佽矾鐢便€佺姸鎬佷笉锟?
    - 鏂板鎵胯繍鏂硅兘鍔涚敾鍍忥紙鍙€夛級
    - 绉熸埛鏈韩鍙互鍦ㄤ竴瀹氭潯浠朵笅杞彉涓烘壙杩愭柟锛屽鎴凤紝浠撳簱瀹炰綋
    - 鏂板浣撶Н銆佹椂鏁堢瓑鍙€夊瓧锟?
    - 鏂板鍖归厤鐩稿叧鎺ュ彛锛堜笉鏀瑰姩鍘熸湁 claim/award 娴佺▼锟?
servers:
  - url: http://localhost:3000
    description: 寮€鍙戠幆锟?
tags:
  - name: setup
    description: 骞冲彴鍒濆鍖栵紙棣栨瀹夎锟?
  - name: admin-auth
    description: 骞冲彴绠＄悊锟?- 璁よ瘉涓庝細锟?
  - name: admin-user
    description: 骞冲彴绠＄悊锟?- 鐢ㄦ埛绠＄悊
  - name: admin-tenant
    description: 骞冲彴绠＄悊锟?- 绉熸埛绠＄悊
  - name: admin-order
    description: 骞冲彴绠＄悊锟?- 璁㈠崟绠＄悊
  - name: customer-order
    description: 瀹㈡埛绉熸埛 - 鍒涘缓涓庢煡鐪嬭嚜宸辩殑璁㈠崟
  - name: carrier-order
    description: 鎵胯繍鏂圭锟?- 璁ら銆佹墽琛岃锟?
  - name: public
    description: 鍏叡鎺ュ彛锛堝皬绋嬪簭浣跨敤锛屾湭鏉ュ簾寮冿級
  - name: auth
    description: 绉熸埛璁よ瘉涓庝細锟?
  - name: matching
    description: 鏅鸿兘鍖归厤锛堟柊澧烇紝鍙€変娇鐢級
components:
  securitySchemes:
    AdminSessionAuth:
      type: apiKey
      in: cookie
      name: connect.sid
      description: 骞冲彴绠＄悊鍛樼櫥褰曞悗鑷姩鎼哄甫锛堢敱 Express Session 绠＄悊锟?
    TenantSessionAuth:
      type: apiKey
      in: cookie
      name: connect.sid
      description: 绉熸埛鐧诲綍鍚庤嚜鍔ㄦ惡甯︼紙锟?Express Session 绠＄悊锟?
  schemas:
    CustomerWebRegistration:
      type: object
      required:
        - contact_phone
        - password
        - roles
      properties:
        contact_phone:
          type: string
          pattern: ^1[3-9][0-9]{9}$
          example: '13800138000'
        password:
          type: string
          minLength: 6
          example: password123
        roles:
          type: array
          items:
            type: string
            enum:
              - customer
          example:
            - customer
    Username:
      type: string
      pattern: ^[a-zA-Z0-9_-]{3,20}$
      example: user_name_123
    Name:
      type: string
      pattern: ^[\u4e00-\u9fa5a-zA-Z0-9_-]{1,50}$
      example: 寮犱笁
    Address:
      type: string
      pattern: ^[\u4e00-\u9fa5a-zA-Z0-9\s\S]{1,200}$
      example: 鍖椾含甯傛湞闃冲尯鏌愭煇琛楅亾123锟?
    TenantApplication:
      type: object
      required:
        - name
        - contact_person
        - contact_phone
        - email
        - password
        - roles
      properties:
        name:
          $ref: '#/components/schemas/Name'
        contact_person:
          $ref: '#/components/schemas/Name'
        contact_phone:
          type: string
          pattern: ^1[3-9][0-9]{9}$
        email:
          type: string
          format: email
        password:
          type: string
          minLength: 6
        roles:
          type: array
          items:
            type: string
            enum:
              - customer
              - carrier
          minItems: 1
          example:
            - customer
            - carrier
        address:
          $ref: '#/components/schemas/Address'
        service_radius_km:
          type: integer
          minimum: 1
          example: 200
        capacity_kg:
          type: number
          minimum: 0.1
          example: 5000
        capacity_m3:
          type: number
          minimum: 0.1
          example: 30
        base_price_per_km:
          type: number
          minimum: 0.01
          example: 2.5
    TenantProfile:
      type: object
      properties:
        id:
          type: string
        name:
          $ref: '#/components/schemas/Name'
        contact_person:
          $ref: '#/components/schemas/Name'
        roles:
          type: array
          items:
            type: string
            enum:
              - customer
              - carrier
        address:
          $ref: '#/components/schemas/Address'
        service_radius_km:
          type: integer
        capacity_kg:
          type: number
        capacity_m3:
          type: number
        base_price_per_km:
          type: number
        avg_rating:
          type: number
          minimum: 0
          maximum: 5
    QuoteRequest:
      type: object
      required:
        - price
      properties:
        price:
          type: number
          minimum: 0.01
          example: 150
        estimated_hours:
          type: integer
          minimum: 1
          example: 24
        estimated_arrival:
          type: string
          format: date-time
          example: '2026-01-14T18:00:00Z'
        note:
          type: string
          example: 鑷湁杞﹁締,24灏忔椂鍐呰锟?
    QuoteItem:
      type: object
      properties:
        id:
          type: string
        order_id:
          type: string
        carrier_tenant_id:
          type: string
        carrier_tenant_name:
          type: string
        price:
          type: number
        estimated_hours:
          type: integer
        estimated_arrival:
          type: string
          format: date-time
        avg_rating:
          type: number
        match_score:
          type: number
        note:
          type: string
        created_at:
          type: string
          format: date-time
    CreateOrderRequest:
      type: object
      required:
        - pickup_address
        - delivery_address
        - weight_kg
      properties:
        pickup_address:
          type: string
          example: 鍖椾含甯傛湞闃冲尯XX澶у帵
        delivery_address:
          type: string
          example: 涓婃捣甯傛郸涓滄柊鍖篩Y鍥尯
        weight_kg:
          type: number
          format: float
          minimum: 0.1
          example: 25.5
        cargo_type:
          type: string
          enum:
            - 瀹跺叿瀹剁數
            - 瑁呬慨寤烘潗
            - 鍔炲叕鐢ㄥ搧
            - 蹇€掑寘锟?
            - 鍏朵粬
          description: 璐х墿绫诲瀷
          example: 瀹跺叿瀹剁數
        cargo_remark:
          type: string
          description: 璐х墿澶囨敞
          example: 鏄撶鍝侊紝璇峰皬蹇冩惉锟?
        length:
          type: number
          minimum: 0.01
          description: 璐х墿闀垮害(锟?
          example: 1.2
        width:
          type: number
          minimum: 0.01
          description: 璐х墿瀹藉害(锟?
          example: 0.8
        height:
          type: number
          minimum: 0.01
          description: 璐х墿楂樺害(锟?
          example: 0.6
        vehicle_type:
          type: string
          enum:
            - 鏃犱汉锟?
            - 鏈変汉锟?
          description: 杞﹀瀷瑕佹眰
          example: 鏈変汉锟?
        pickup_time:
          type: string
          format: date-time
          description: 棰勭害鍙栬揣鏃堕棿
          example: '2026-01-15T10:00:00Z'
        volume_m3:
          type: number
          minimum: 0.01
          example: 1.2
        required_delivery_time:
          type: string
          format: date-time
          example: '2026-01-15T12:00:00Z'
        quote_deadline:
          type: string
          format: date-time
          example: '2026-01-14T10:00:00Z'
        customer_name:
          $ref: '#/components/schemas/Name'
        customer_phone:
          type: string
          pattern: ^1[3-9]\d{9}$
          example: '13800138000'
        description:
          type: string
          example: 鏄撶鍝侊紝璇疯交鎷胯交锟?
    OrderItem:
      type: object
      properties:
        id:
          type: string
          example: order_123e4567-e89b-12d3-a456-426614174000
        customer_tenant_id:
          type: string
        customer_tenant_name:
          type: string
        carrier_tenant_id:
          type: string
          nullable: true
        carrier_tenant_name:
          type: string
          nullable: true
        pickup_address:
          type: string
        delivery_address:
          type: string
        weight_kg:
          type: number
        volume_m3:
          type: number
        required_delivery_time:
          type: string
          format: date-time
        quote_deadline:
          type: string
          format: date-time
        status:
          type: string
          enum:
            - created
            - pending
            - pending_claim
            - claimed
            - quoted
            - awarded
            - dispatched
            - in_transit
            - delivered
            - cancelled
        created_at:
          type: string
          format: date-time
        quotes:
          type: array
          items:
            $ref: '#/components/schemas/QuoteItem'
          nullable: true
        order_id:
          type: string
          example: ORD-20260205-001
          description: 璁㈠崟鐨勫敮涓€鏍囪瘑绗︼紝鐢ㄤ簬鍓嶇灞曠ず鍜岃烦杞鎯呴〉
        updated_at:
          type: string
          format: date-time
          example: '2026-02-05T10:35:00Z'
          description: 璁㈠崟鏈€鍚庢洿鏂版椂锟?
        sender_info:
          type: string
          example: '{"name": "寮犱笁", "phone": "13800138000"}'
          description: 鍙戣揣浜轰俊鎭紙JSON 瀛楃涓叉牸寮忥級
        receiver_info:
          type: string
          example: '{"name": "鏉庡洓", "phone": "13900139000"}'
          description: 鏀惰揣浜轰俊鎭紙JSON 瀛楃涓叉牸寮忥級
        cargo_type:
          type: string
          example: furniture
          description: 璐х墿绫诲瀷
        length:
          type: number
          example: 1.2
          description: 璐х墿闀垮害锛堢背锟?
        width:
          type: number
          example: 0.8
          description: 璐х墿瀹藉害锛堢背锟?
        height:
          type: number
          example: 0.6
          description: 璐х墿楂樺害锛堢背锟?
        description:
          type: string
          example: 璇峰姟蹇呭皬蹇冭交锟?
          description: 璁㈠崟澶囨敞
        total_price:
          type: number
          example: 299.99
          description: 璁㈠崟鎬讳环锟?
      required:
        - id
        - order_id
        - status
        - created_at
        - pickup_address
        - delivery_address
        - sender_info
        - receiver_info
        - cargo_type
        - weight_kg
        - length
        - width
        - height
        - volume_m3
        - total_price
        - customer_tenant_id
        - customer_tenant_name
    OrderListResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: 鑾峰彇鎴愬姛
        data:
          type: object
          properties:
            total:
              type: integer
              example: 5
            page:
              type: integer
              example: 1
            limit:
              type: integer
              example: 10
            orders:
              type: array
              items:
                $ref: '#/components/schemas/OrderItem'
      required:
        - success
        - data
    ErrorResponse:
      type: object
      required:
        - error
        - message
      properties:
        error:
          type: string
          example: TENANT_ROLE_NOT_ENABLED
        message:
          type: string
          example: 褰撳墠绉熸埛鏈惎鐢ㄥ鎴疯锟?
    TenantListItem:
      type: object
      properties:
        id:
          type: integer
        name:
          $ref: '#/components/schemas/Name'
        contact_person:
          $ref: '#/components/schemas/Name'
        contact_phone:
          type: string
          pattern: ^1[3-9][0-9]{9}$
        email:
          type: string
          format: email
        status:
          type: string
          enum:
            - pending
            - approved
            - rejected
            - active
            - inactive
        created_at:
          type: string
          format: date-time
        address:
          type: string
        service_radius_km:
          type: integer
        capacity_kg:
          type: number
        capacity_m3:
          type: number
        base_price_per_km:
          type: number
        avg_rating:
          type: number
          minimum: 0
          maximum: 5
    TenantDetail:
      allOf:
        - $ref: '#/components/schemas/TenantListItem'
        - type: object
          properties:
            updated_at:
              type: string
              format: date-time
            vehicles:
              type: array
              items:
                $ref: '#/components/schemas/VehicleInfo'
            financial_info:
              $ref: '#/components/schemas/TenantFinancialInfo'
            contact_info:
              $ref: '#/components/schemas/TenantContactInfo'
    VehicleInfo:
      type: object
      properties:
        id:
          type: integer
        plate_number:
          type: string
        type:
          type: string
        length:
          type: number
        width:
          type: number
        height:
          type: number
        max_weight:
          type: number
        volume:
          type: number
        status:
          type: string
        driver_name:
          type: string
        driver_phone:
          type: string
        image_url:
          type: string
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    TenantFinancialInfo:
      type: object
      properties:
        bank_account_number:
          type: string
        bank_name:
          type: string
        tax_id:
          type: string
        settlement_cycle:
          type: string
        credit_limit:
          type: number
        outstanding_balance:
          type: number
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    TenantContactInfo:
      type: object
      properties:
        finance_contact_name:
          type: string
        finance_contact_phone:
          type: string
        finance_contact_email:
          type: string
        support_contact_name:
          type: string
        support_contact_phone:
          type: string
        support_contact_email:
          type: string
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    PaginationInfo:
      type: object
      properties:
        current_page:
          type: integer
          example: 1
        per_page:
          type: integer
          example: 10
        total:
          type: integer
          example: 100
        total_pages:
          type: integer
          example: 10
        has_next:
          type: boolean
          example: true
        has_prev:
          type: boolean
          example: false
    PricingRule:
      type: object
      properties:
        id:
          type: integer
          example: 1
        rule_name:
          type: string
          example: 鏍囧噯瀹氫环瑙勫垯
        base_price:
          type: number
          example: 10
        price_per_km:
          type: number
          example: 2.5
        price_per_hour:
          type: number
          example: 5
        price_per_kg:
          type: number
          example: 1
        cold_storage_surcharge:
          type: number
          example: 0.5
        peak_hour_multiplier:
          type: number
          example: 1.5
        off_peak_hour_multiplier:
          type: number
          example: 0.8
        weather_multiplier:
          type: number
          example: 1.2
        min_price:
          type: number
          example: 5
        max_price:
          type: number
          example: 1000
        time_slot_rules:
          type: object
          example: {}
        region_rules:
          type: object
          example: {}
        vehicle_type_rules:
          type: object
          example: {}
        active:
          type: boolean
          example: true
        created_at:
          type: string
          format: date-time
          example: '2026-01-25T15:30:00Z'
        updated_at:
          type: string
          format: date-time
          example: '2026-01-25T15:30:00Z'
    CreatePricingRuleRequest:
      type: object
      required:
        - rule_name
      properties:
        rule_name:
          type: string
          example: 鏍囧噯瀹氫环瑙勫垯
          description: 瀹氫环瑙勫垯鍚嶇О
        base_price:
          type: number
          example: 10
          description: 鍩虹浠锋牸
        price_per_km:
          type: number
          example: 2.5
          description: 姣忓叕閲屼环锟?
        price_per_hour:
          type: number
          example: 5
          description: 姣忓皬鏃朵环锟?
        price_per_kg:
          type: number
          example: 1
          description: 姣忓叕鏂や环锟?
        cold_storage_surcharge:
          type: number
          example: 0.5
          description: 鍐疯棌闄勫姞锟?
        peak_hour_multiplier:
          type: number
          example: 1.5
          description: 楂樺嘲鏃舵鍊嶇巼
        off_peak_hour_multiplier:
          type: number
          example: 0.8
          description: 闈為珮宄版椂娈靛€嶇巼
        weather_multiplier:
          type: number
          example: 1.2
          description: 澶╂皵鍊嶇巼
        min_price:
          type: number
          example: 5
          description: 鏈€浣庝环锟?
        max_price:
          type: number
          example: 1000
          description: 鏈€楂樹环锟?
        time_slot_rules:
          type: object
          description: 鏃舵瑙勫垯
        region_rules:
          type: object
          description: 鍦板尯瑙勫垯
        vehicle_type_rules:
          type: object
          description: 杞﹀瀷瑙勫垯
        active:
          type: boolean
          example: true
          description: 鏄惁婵€锟?
    UpdatePricingRuleRequest:
      type: object
      properties:
        rule_name:
          type: string
          example: 鏍囧噯瀹氫环瑙勫垯
          description: 瀹氫环瑙勫垯鍚嶇О
        base_price:
          type: number
          example: 10
          description: 鍩虹浠锋牸
        price_per_km:
          type: number
          example: 2.5
          description: 姣忓叕閲屼环锟?
        price_per_hour:
          type: number
          example: 5
          description: 姣忓皬鏃朵环锟?
        price_per_kg:
          type: number
          example: 1
          description: 姣忓叕鏂や环锟?
        cold_storage_surcharge:
          type: number
          example: 0.5
          description: 鍐疯棌闄勫姞锟?
        peak_hour_multiplier:
          type: number
          example: 1.5
          description: 楂樺嘲鏃舵鍊嶇巼
        off_peak_hour_multiplier:
          type: number
          example: 0.8
          description: 闈為珮宄版椂娈靛€嶇巼
        weather_multiplier:
          type: number
          example: 1.2
          description: 澶╂皵鍊嶇巼
        min_price:
          type: number
          example: 5
          description: 鏈€浣庝环锟?
        max_price:
          type: number
          example: 1000
          description: 鏈€楂樹环锟?
        time_slot_rules:
          type: object
          description: 鏃舵瑙勫垯
        region_rules:
          type: object
          description: 鍦板尯瑙勫垯
        vehicle_type_rules:
          type: object
          description: 杞﹀瀷瑙勫垯
        active:
          type: boolean
          description: 鏄惁婵€锟?
    Pagination:
      type: object
      properties:
        current_page:
          type: integer
          example: 1
        per_page:
          type: integer
          example: 10
        total:
          type: integer
          example: 100
        total_pages:
          type: integer
          example: 10
        has_next:
          type: boolean
          example: true
        has_prev:
          type: boolean
          example: false
    CarrierPricingConfig:
      type: object
      properties:
        id:
          type: integer
          example: 1
        carrier_id:
          type: integer
          example: 1
        config_name:
          type: string
          example: 鏍囧噯閰嶉€佸畾锟?
        base_price:
          type: number
          example: 15
        price_per_km:
          type: number
          example: 3
        price_per_hour:
          type: number
          example: 6
        price_per_kg:
          type: number
          example: 1.5
        cold_storage_surcharge:
          type: number
          example: 0.8
        peak_hour_multiplier:
          type: number
          example: 1.8
        off_peak_hour_multiplier:
          type: number
          example: 0.7
        weather_multiplier:
          type: number
          example: 1.3
        min_price:
          type: number
          example: 8
        max_price:
          type: number
          example: 200
        time_slot_rules:
          type: object
          example: {}
        region_rules:
          type: object
          example: {}
        vehicle_type_rules:
          type: object
          example: {}
        active:
          type: boolean
          example: true
        created_at:
          type: string
          format: date-time
          example: '2026-01-25T15:30:00Z'
        updated_at:
          type: string
          format: date-time
          example: '2026-01-25T15:30:00Z'
    CreateCarrierPricingConfigRequest:
      type: object
      required:
        - carrier_id
        - config_name
      properties:
        carrier_id:
          type: integer
          example: 1
          description: 鎵胯繍鍟咺D
        config_name:
          type: string
          example: 鏍囧噯閰嶉€佸畾锟?
          description: 閰嶇疆鍚嶇О
        base_price:
          type: number
          example: 15
          description: 鍩虹浠锋牸
        price_per_km:
          type: number
          example: 3
          description: 姣忓叕閲屼环锟?
        price_per_hour:
          type: number
          example: 6
          description: 姣忓皬鏃朵环锟?
        price_per_kg:
          type: number
          example: 1.5
          description: 姣忓叕鏂や环锟?
        cold_storage_surcharge:
          type: number
          example: 0.8
          description: 鍐疯棌闄勫姞锟?
        peak_hour_multiplier:
          type: number
          example: 1.8
          description: 楂樺嘲鏃舵鍊嶇巼
        off_peak_hour_multiplier:
          type: number
          example: 0.7
          description: 闈為珮宄版椂娈靛€嶇巼
        weather_multiplier:
          type: number
          example: 1.3
          description: 澶╂皵鍊嶇巼
        min_price:
          type: number
          example: 8
          description: 鏈€浣庝环锟?
        max_price:
          type: number
          example: 200
          description: 鏈€楂樹环锟?
        time_slot_rules:
          type: object
          description: 鏃舵瑙勫垯
        region_rules:
          type: object
          description: 鍦板尯瑙勫垯
        vehicle_type_rules:
          type: object
          description: 杞﹀瀷瑙勫垯
        active:
          type: boolean
          example: true
          description: 鏄惁婵€锟?
    UpdateCarrierPricingConfigRequest:
      type: object
      properties:
        config_name:
          type: string
          example: 鏍囧噯閰嶉€佸畾锟?
          description: 閰嶇疆鍚嶇О
        base_price:
          type: number
          example: 15
          description: 鍩虹浠锋牸
        price_per_km:
          type: number
          example: 3
          description: 姣忓叕閲屼环锟?
        price_per_hour:
          type: number
          example: 6
          description: 姣忓皬鏃朵环锟?
        price_per_kg:
          type: number
          example: 1.5
          description: 姣忓叕鏂や环锟?
        cold_storage_surcharge:
          type: number
          example: 0.8
          description: 鍐疯棌闄勫姞锟?
        peak_hour_multiplier:
          type: number
          example: 1.8
          description: 楂樺嘲鏃舵鍊嶇巼
        off_peak_hour_multiplier:
          type: number
          example: 0.7
          description: 闈為珮宄版椂娈靛€嶇巼
        weather_multiplier:
          type: number
          example: 1.3
          description: 澶╂皵鍊嶇巼
        min_price:
          type: number
          example: 8
          description: 鏈€浣庝环锟?
        max_price:
          type: number
          example: 200
          description: 鏈€楂樹环锟?
        time_slot_rules:
          type: object
          description: 鏃舵瑙勫垯
        region_rules:
          type: object
          description: 鍦板尯瑙勫垯
        vehicle_type_rules:
          type: object
          description: 杞﹀瀷瑙勫垯
        active:
          type: boolean
          description: 鏄惁婵€锟?
    OrderDetails:
      type: object
      properties:
        distance_km:
          type: number
          example: 15.5
        duration_hours:
          type: number
          example: 2.5
        weight_kg:
          type: number
          example: 100
        is_cold_storage:
          type: boolean
          example: false
        time_slot:
          type: string
          example: morning
        weather_condition:
          type: string
          example: normal
        region:
          type: string
          example: beijing_haidian
        vehicle_type:
          type: string
          example: van
        pickup_address:
          type: string
          example: 鍖椾含甯傛捣娣€鍖轰腑鍏虫潙澶ц1锟?
        delivery_address:
          type: string
          example: 鍖椾含甯傛湞闃冲尯鍥借锤澶у帵
        cargo_type:
          type: string
          example: electronics
    CarrierQuote:
      type: object
      properties:
        carrier_id:
          type: integer
          example: 1
        carrier_name:
          type: string
          example: 椤轰赴閫熻繍
        avg_rating:
          type: number
          example: 4.8
        price:
          type: number
          example: 150
        base_price:
          type: number
          example: 10
        distance_cost:
          type: number
          example: 37.5
        duration_cost:
          type: number
          example: 12.5
        weight_cost:
          type: number
          example: 100
        cold_storage_surcharge:
          type: number
          example: 0
        time_slot_multiplier:
          type: number
          example: 1
        region_multiplier:
          type: number
          example: 1
        vehicle_type_multiplier:
          type: number
          example: 1
        weather_multiplier:
          type: number
          example: 1
        peak_hour_multiplier:
          type: number
          example: 1
        off_peak_multiplier:
          type: number
          example: 1
    AddonsConfig:
      type: object
      properties:
        loading_fee:
          type: number
          example: 50
          description: 瑁呭嵏锟?
        waiting_fee:
          type: number
          example: 30
          description: 绛夊緟锟?
        overtime_fee:
          type: number
          example: 100
          description: 瓒呮椂锟?
        special_handling_fee:
          type: number
          example: 80
          description: 鐗规畩澶勭悊锟?
        cold_storage_fee:
          type: number
          example: 40
          description: 鍐疯棌闄勫姞锟?
        insurance_fee:
          type: number
          example: 20
          description: 淇濋櫓锟?
        other_fees:
          type: array
          items:
            type: object
            properties:
              name:
                type: string
                example: 澶滈棿閰嶉€佽垂
              amount:
                type: number
                example: 60
              description:
                type: string
                example: 澶滈棿閰嶉€侀澶栬垂锟?
  responses:
    UnauthorizedError:
      description: 鏈锟?
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    ForbiddenError:
      description: 鏉冮檺涓嶈冻锛堝瑙掕壊涓嶅尮閰嶏級
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    NotFoundError:
      description: 璧勬簮鏈壘锟?
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              error:
                type: string
                example: NOT_FOUND
              message:
                type: string
                example: 璧勬簮鏈壘锟?
    InternalServerError:
      description: 鏈嶅姟鍣ㄥ唴閮ㄩ敊锟?
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              error:
                type: string
                example: INTERNAL_SERVER_ERROR
              message:
                type: string
                example: 鏈嶅姟鍣ㄥ唴閮ㄩ敊锟?
    BadRequestError:
      description: 璇锋眰鍙傛暟閿欒
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              error:
                type: string
                example: BAD_REQUEST
              message:
                type: string
                example: 璇锋眰鍙傛暟閿欒
paths:
  /api/admin/tenants:
    get:
      tags:
        - admin-tenant
      operationId: listAllTenants
      summary: 鑾峰彇鎵€鏈夌鎴凤紙鍒嗛〉銆佸彲绛涢€夛級
      description: 鑾峰彇骞冲彴鎵€鏈夌鎴风殑鍒楄〃锛屾敮鎸佸垎椤点€佺姸鎬佺瓫閫夊拰鍏抽敭璇嶆悳绱拷?
      security:
        - AdminSessionAuth: []
      parameters:
        - name: page
          in: query
          description: 椤电爜
          required: false
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          description: 姣忛〉鏁伴噺
          required: false
          schema:
            type: integer
            default: 10
        - name: status
          in: query
          description: 绛涢€夌鎴风姸锟?
          required: false
          schema:
            type: string
            enum:
              - pending
              - approved
              - rejected
              - active
              - inactive
        - name: search
          in: query
          description: 鎼滅储绉熸埛鍚嶇О鎴栬仈绯讳汉
          required: false
          schema:
            type: string
      responses:
        '200':
          description: 绉熸埛鍒楄〃
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      tenants:
                        type: array
                        items:
                          $ref: '#/components/schemas/TenantListItem'
                      pagination:
                        $ref: '#/components/schemas/PaginationInfo'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /api/admin/tenants/{id}:
    get:
      tags:
        - admin-tenant
      operationId: getTenantById
      summary: 鑾峰彇鍗曚釜绉熸埛璇︽儏
      description: 鑾峰彇鎸囧畾ID绉熸埛鐨勫畬鏁翠俊鎭紝鍖呮嫭鍩烘湰淇℃伅銆佽溅杈嗐€佽储鍔″拰瀹㈡湇淇℃伅锟?
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: 绉熸埛璇︽儏
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/TenantDetail'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
    put:
      tags:
        - admin-tenant
      operationId: updateTenantBasicInfo
      summary: 鏇存柊绉熸埛鍩烘湰淇℃伅
      description: 鏇存柊鎸囧畾ID绉熸埛鐨勫熀鏈俊鎭紙濡傜姸鎬併€佽仈绯讳汉绛夛級锟?
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                contact_person:
                  type: string
                contact_phone:
                  type: string
                email:
                  type: string
                  format: email
                status:
                  type: string
                  enum:
                    - pending
                    - approved
                    - rejected
                    - active
                    - inactive
                address:
                  type: string
      responses:
        '200':
          description: 鏇存柊鎴愬姛
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/TenantListItem'
                  message:
                    type: string
        '400':
          $ref: '#/components/responses/ForbiddenError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/admin/reports/overview-stats:
    get:
      tags:
        - admin-reports
      summary: 鑾峰彇骞冲彴姒傝缁熻鏁版嵁
      operationId: getOverviewStats
      security:
        - AdminSessionAuth: []
      responses:
        '200':
          description: 骞冲彴姒傝缁熻鏁版嵁
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      total_orders:
                        type: integer
                        example: 150
                      completed_orders:
                        type: integer
                        example: 120
                      in_transit_orders:
                        type: integer
                        example: 20
                      pending_orders:
                        type: integer
                        example: 5
                      processing_orders:
                        type: integer
                        example: 5
                      cancelled_orders:
                        type: integer
                        example: 0
                      total_customers:
                        type: integer
                        example: 45
                      recent_orders:
                        type: array
                        items:
                          $ref: '#/components/schemas/OrderItem'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /api/admin/tenants/approved:
    get:
      tags:
        - admin-tenant
      operationId: listApprovedTenants
      summary: 鑾峰彇宸叉壒鍑嗙殑绉熸埛鍒楄〃
      description: 鑾峰彇鎵€鏈夊凡鎵瑰噯鐘舵€佺殑绉熸埛鍒楄〃
      security:
        - AdminSessionAuth: []
      parameters:
        - name: page
          in: query
          description: 椤电爜
          required: false
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          description: 姣忛〉鏁伴噺
          required: false
          schema:
            type: integer
            default: 10
      responses:
        '200':
          description: 宸叉壒鍑嗙鎴峰垪锟?
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      tenants:
                        type: array
                        items:
                          $ref: '#/components/schemas/TenantListItem'
                      pagination:
                        $ref: '#/components/schemas/PaginationInfo'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /api/admin/tenants/rejected:
    get:
      tags:
        - admin-tenant
      operationId: listRejectedTenants
      summary: 鑾峰彇宸查┏鍥炵殑绉熸埛鍒楄〃
      description: 鑾峰彇鎵€鏈夊凡椹冲洖鐘舵€佺殑绉熸埛鍒楄〃
      security:
        - AdminSessionAuth: []
      parameters:
        - name: page
          in: query
          description: 椤电爜
          required: false
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          description: 姣忛〉鏁伴噺
          required: false
          schema:
            type: integer
            default: 10
        - name: search
          in: query
          description: 鎼滅储鍏抽敭璇嶏紙绉熸埛鍚嶇О鎴栬仈绯绘柟寮忥級
          required: false
          schema:
            type: string
      responses:
        '200':
          description: 宸查┏鍥炵鎴峰垪锟?
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      tenants:
                        type: array
                        items:
                          $ref: '#/components/schemas/TenantListItem'
                      pagination:
                        $ref: '#/components/schemas/PaginationInfo'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /api/admin/tenants/{id}/financial:
    put:
      tags:
        - admin-tenant
      operationId: updateTenantFinancialInfo
      summary: 鏇存柊绉熸埛璐㈠姟淇℃伅
      description: 鏇存柊鎸囧畾ID绉熸埛鐨勮储鍔′俊鎭拷?
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TenantFinancialInfo'
      responses:
        '200':
          description: 鏇存柊鎴愬姛
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/TenantFinancialInfo'
                  message:
                    type: string
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/admin/tenants/{id}/contact:
    put:
      tags:
        - admin-tenant
      operationId: updateTenantContactInfo
      summary: 鏇存柊绉熸埛鑱旂郴淇℃伅
      description: 鏇存柊鎸囧畾ID绉熸埛鐨勮储鍔″拰瀹㈡湇鑱旂郴淇℃伅锟?
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TenantContactInfo'
      responses:
        '200':
          description: 鏇存柊鎴愬姛
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/TenantContactInfo'
                  message:
                    type: string
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/admin/vehicles:
    get:
      tags:
        - admin-vehicle
      operationId: listAllVehicles
      summary: 鑾峰彇鎵€鏈夎溅杈嗗垪锟?
      description: 鑾峰彇骞冲彴涓墍鏈夎溅杈嗙殑淇℃伅
      security:
        - AdminSessionAuth: []
      parameters:
        - name: page
          in: query
          description: 椤电爜
          required: false
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          description: 姣忛〉鏁伴噺
          required: false
          schema:
            type: integer
            default: 10
        - name: search
          in: query
          description: 鎼滅储鍏抽敭璇嶏紙杞︾墝鍙枫€佽溅鍨嬬瓑锟?
          required: false
          schema:
            type: string
      responses:
        '200':
          description: 杞﹁締鍒楄〃
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      vehicles:
                        type: array
                        items:
                          $ref: '#/components/schemas/VehicleInfo'
                      pagination:
                        $ref: '#/components/schemas/PaginationInfo'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
    post:
      tags:
        - admin-vehicle
      operationId: addTenantVehicle
      summary: 娣诲姞杞﹁締
      description: 娣诲姞涓€杈嗚溅杈嗕俊锟?
      security:
        - AdminSessionAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VehicleInfo'
      responses:
        '201':
          description: 娣诲姞鎴愬姛
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/VehicleInfo'
                  message:
                    type: string
        '400':
          $ref: '#/components/responses/ForbiddenError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /api/admin/vehicles/search:
    get:
      tags:
        - admin-vehicle
      operationId: searchVehicles
      summary: 鎼滅储杞﹁締
      description: 鏍规嵁鏉′欢鎼滅储杞﹁締
      security:
        - AdminSessionAuth: []
      parameters:
        - name: plate_number
          in: query
          description: 杞︾墝锟?
          required: false
          schema:
            type: string
        - name: type
          in: query
          description: 杞﹁締绫诲瀷
          required: false
          schema:
            type: string
        - name: status
          in: query
          description: 杞﹁締鐘讹拷?
          required: false
          schema:
            type: string
      responses:
        '200':
          description: 鍖归厤鐨勮溅杈嗗垪锟?
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/VehicleInfo'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /api/admin/vehicles/{id}:
    get:
      tags:
        - admin-vehicle
      operationId: getVehicleById
      summary: 鑾峰彇鎸囧畾杞﹁締璇︽儏
      description: 鑾峰彇鎸囧畾ID鐨勮溅杈嗚缁嗕俊锟?
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: 杞﹁締璇︽儏
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/VehicleInfo'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/admin/tenants/{id}/vehicles:
    post:
      tags:
        - admin-tenant
      operationId: addTenantVehicle
      summary: 娣诲姞绉熸埛杞﹁締
      description: 涓烘寚瀹欼D鐨勭鎴锋坊鍔犱竴杈嗚溅杈嗕俊鎭拷?
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VehicleInfo'
      responses:
        '201':
          description: 娣诲姞鎴愬姛
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/VehicleInfo'
                  message:
                    type: string
        '400':
          $ref: '#/components/responses/ForbiddenError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/health:
    get:
      summary: 鍋ュ悍妫€锟?
      operationId: healthCheck
      tags:
        - public
      responses:
        '200':
          description: 鏈嶅姟姝ｅ父杩愯
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: ok
        '500':
          description: 鏈嶅姟鍐呴儴閿欒
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /api/customer/order/bind:
    post:
      summary: 灏嗚鍗曠粦瀹氬埌瀹㈡埛锛堥€氳繃鎵嬫満鍙凤級
      operationId: bindOrderToCustomer
      security:
        - TenantSessionAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                order_id:
                  type: integer
                  example: 123456
              required:
                - order_id
      responses:
        '200':
          description: 缁戝畾鎴愬姛
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    type: object
        '400':
          description: 鍙傛暟閿欒鎴栧鎴蜂笉瀛樺湪
        '401':
          description: 鏈櫥锟?
        '404':
          description: 璁㈠崟鏈壘鍒版垨宸茬粦锟?
  /api/customer/orders:
    post:
      tags:
        - customer-order
      summary: 瀹㈡埛鍒涘缓鏂拌锟?
      operationId: createCustomerOrder
      security:
        - TenantSessionAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateOrderRequest'
      responses:
        '201':
          description: 璁㈠崟鍒涘缓鎴愬姛
          content:
            application/json:
              schema:
                type: object
                properties:
                  order_id:
                    type: string
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
    get:
      tags:
        - customer-order
      summary: 鑾峰彇瀹㈡埛鑷繁鐨勮鍗曞垪锟?
      operationId: listCustomerOrders
      security:
        - TenantSessionAuth: []
      responses:
        '200':
          description: 璁㈠崟鍒楄〃
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderListResponse'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /api/customer/orders/{order_id}:
    get:
      tags:
        - customer-order
      summary: 鑾峰彇鍗曚釜瀹㈡埛璁㈠崟璇︽儏
      operationId: getCustomerOrder
      security:
        - TenantSessionAuth: []
      parameters:
        - name: order_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: 璁㈠崟璇︽儏
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderItem'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
    put:
      tags:
        - customer-order
      summary: 鏇存柊瀹㈡埛璁㈠崟锛堝淇敼鍦板潃銆佸娉ㄧ瓑锟?
      operationId: updateCustomerOrder
      security:
        - TenantSessionAuth: []
      parameters:
        - name: order_id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                pickup_address:
                  type: string
                delivery_address:
                  type: string
                description:
                  type: string
      responses:
        '200':
          description: 鏇存柊鎴愬姛
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
    delete:
      tags:
        - customer-order
      summary: 鍒犻櫎瀹㈡埛璁㈠崟锛堜粎闄愭湭璁ら鐘舵€侊級
      operationId: deleteCustomerOrder
      security:
        - TenantSessionAuth: []
      parameters:
        - name: order_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: 鍒犻櫎鎴愬姛
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/customer/orders/{order_id}/quotes:
    get:
      tags:
        - customer-order
      summary: 鑾峰彇璁㈠崟鐨勬姤浠峰垪琛紙鏀寔澶氭壙杩愬晢绔炰环锟?
      operationId: getOrderQuotes
      security:
        - TenantSessionAuth: []
      parameters:
        - name: order_id
          in: path
          required: true
          schema:
            type: string
          description: 璁㈠崟ID
      responses:
        '200':
          description: 鎶ヤ环鍒楄〃
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      order_id:
                        type: string
                        example: order_123
                      quotes:
                        type: array
                        items:
                          type: object
                          properties:
                            carrier:
                              type: object
                              properties:
                                id:
                                  type: integer
                                name:
                                  type: string
                                tenant_name:
                                  type: string
                                phone:
                                  type: string
                            price:
                              type: number
                              example: 150
                            delivery_time:
                              type: string
                              format: date-time
                              example: '2026-01-14T18:00:00Z'
                            remarks:
                              type: string
                              example: 鍙姞鎬ワ紝浣嗛渶棰濆璐圭敤
                            status:
                              type: string
                              example: pending
                            created_at:
                              type: string
                              format: date-time
                              example: '2026-01-13T10:00:00Z'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/setup/status:
    get:
      tags:
        - setup
      summary: 妫€鏌ュ钩鍙版槸鍚﹀凡瀹屾垚鍒濆鍖栵紙鏄惁瀛樺湪绠＄悊鍛橈級
      operationId: getSetupStatus
      responses:
        '200':
          description: 杩斿洖鍒濆鍖栫姸锟?
          content:
            application/json:
              schema:
                type: object
                properties:
                  initialized:
                    type: boolean
                    example: false
        '500':
          description: 鏈嶅姟鍐呴儴閿欒
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /api/setup/admin:
    post:
      tags:
        - setup
      summary: 鍒涘缓棣栦釜骞冲彴绠＄悊鍛橈紙浠呴檺鏈垵濮嬪寲鏃惰皟鐢級
      operationId: createFirstAdmin
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - username
                - password
                - email
                - platform_name
              properties:
                username:
                  $ref: '#/components/schemas/Username'
                password:
                  type: string
                  minLength: 8
                  example: SecurePass123!
                email:
                  type: string
                  format: email
                  example: admin@yourlogistics.com
                platform_name:
                  type: string
                  description: 璇ュ钩鍙板疄渚嬬殑鍚嶇О锛堝鈥滃崕涓滅墿娴佷簯鈥濓級
                  example: 鎴戠殑鐗╂祦骞冲彴
                license_key:
                  type: string
                  description: 鎺堟潈瀵嗛挜锛堝彲閫夛紝鐢ㄤ簬浜у搧鎺堟潈楠岃瘉锟?
                  example: LIC-2026-XXXX-YYYY-ZZZZ
      responses:
        '201':
          description: 鍒濆鍖栨垚锟?
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 骞冲彴鍒濆鍖栨垚锟?
        '400':
          description: 璇锋眰鍙傛暟閿欒
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: 骞冲彴宸插垵濮嬪寲锛岀姝㈤噸澶嶅垱锟?
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /api/auth/ping:
    get:
      summary: 妫€鏌ュ綋鍓嶄細璇濇槸鍚︽湁锟?
      description: 鐢ㄤ簬楠岃瘉鐢ㄦ埛鐧诲綍鐘舵€侊紙Session 鏄惁鏈夋晥锛夛拷?
      security:
        - TenantSessionAuth: []
      tags:
        - auth
      responses:
        '200':
          description: Session 鏈夋晥
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Session is valid
                  user:
                    type: object
                    properties:
                      id:
                        type: string
                        example: user_123
                      name:
                        type: string
                        example: 寮犱笁
        '401':
          description: Session 鏃犳晥鎴栨湭鐧诲綍
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Session is invalid or not logged in
  /api/admin/login:
    post:
      tags:
        - admin-auth
      summary: 骞冲彴绠＄悊鍛樼櫥锟?
      operationId: adminLogin
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - username
                - password
              properties:
                username:
                  $ref: '#/components/schemas/Username'
                password:
                  type: string
                  example: SecurePass123!
      responses:
        '200':
          description: 鐧诲綍鎴愬姛,Set-Cookie 鑷姩璁剧疆 session
        '401':
          description: 鐢ㄦ埛鍚嶆垨瀵嗙爜閿欒
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /api/admin/logout:
    post:
      tags:
        - admin-auth
      summary: 骞冲彴绠＄悊鍛樼櫥锟?
      operationId: adminLogout
      security:
        - AdminSessionAuth: []
      responses:
        '200':
          description: 鐧诲嚭鎴愬姛
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 宸插畨鍏ㄩ€€锟?
  /api/admin/profile:
    get:
      tags:
        - admin-auth
      summary: 鑾峰彇褰撳墠绠＄悊鍛樺熀鏈俊锟?
      operationId: getAdminProfile
      security:
        - AdminSessionAuth: []
      responses:
        '200':
          description: 绠＄悊鍛樹俊锟?
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                  username:
                    type: string
                  email:
                    type: string
                  platform_name:
                    type: string
                  created_at:
                    type: string
                    format: date-time
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /api/admin/users:
    post:
      tags:
        - admin-user
      summary: 鍒涘缓鏂扮殑骞冲彴绠＄悊鍛樼敤鎴凤紙闇€褰撳墠绠＄悊鍛樻潈闄愶級
      operationId: createAdminUser
      security:
        - AdminSessionAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - username
                - password
                - email
              properties:
                username:
                  $ref: '#/components/schemas/Username'
                password:
                  type: string
                  minLength: 8
                email:
                  type: string
                  format: email
                role:
                  type: string
                  enum:
                    - admin
                    - operator
                  default: admin
      responses:
        '201':
          description: 绠＄悊鍛樺垱寤烘垚锟?
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        '409':
          description: 鐢ㄦ埛鍚嶆垨閭宸插瓨锟?
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /api/admin/tenants/pending:
    get:
      tags:
        - admin-tenant
      operationId: listPendingTenants
      security:
        - AdminSessionAuth: []
      responses:
        '200':
          description: 寰呭鏍哥鎴峰垪锟?
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/TenantApplication'
  /api/admin/tenants/{id}/approve:
    put:
      tags:
        - admin-tenant
      summary: 鎵瑰噯绉熸埛鐢宠
      operationId: approveTenant
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                roles:
                  type: array
                  items:
                    type: string
                    enum:
                      - customer
                      - carrier
      responses:
        '200':
          description: 瀹℃牳閫氳繃
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/admin/tenants/{id}/reject:
    put:
      tags:
        - admin-tenant
      summary: 鎷掔粷绉熸埛鐢宠
      operationId: rejectTenant
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                notes:
                  type: string
                  description: 鎷掔粷鍘熷洜锛堝彲閫夛級
      responses:
        '200':
          description: 鎷掔粷鎴愬姛
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 绉熸埛鐢宠宸叉嫆锟?
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/admin/orders:
    get:
      tags:
        - admin-order
      operationId: listAdminOrders
      security:
        - AdminSessionAuth: []
      responses:
        '200':
          description: 鎵€鏈夎鍗曞垪锟?
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderListResponse'
  /api/admin/orders/{id}/status:
    put:
      tags:
        - admin-order
      summary: 鎬诲悗鍙拌皟搴﹁锟?
      operationId: updateOrderStatus
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - status
              properties:
                status:
                  type: string
                  enum:
                    - pending
                    - pending_claim
                    - available
                    - created
                    - claimed
                    - awarded
                    - dispatched
                    - in_transit
                    - delivered
                    - cancelled
                  example: cancelled
      responses:
        '200':
          description: 鐘舵€佹洿鏂版垚锟?
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 璁㈠崟鐘舵€佸凡鏇存柊
        '400':
          description: 鐘舵€佸€兼棤锟?
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/public/orders/{id}:
    get:
      operationId: fetchPublicOrder
      summary: 鑾峰彇鍏紑璁㈠崟璇︽儏
      description: 閫氳繃杩借釜鍙疯幏鍙栬鍗曠殑鍏紑淇℃伅锟?
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: 璁㈠崟鐨勮拷韪彿 (tracking_number)
      responses:
        '200':
          description: 璁㈠崟淇℃伅鑾峰彇鎴愬姛
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  order:
                    $ref: '#/components/schemas/OrderItem'
        '404':
          description: 璁㈠崟鏈壘锟?
        '500':
          description: 鏈嶅姟鍣ㄥ唴閮ㄩ敊锟?
  /api/public/orders:
    post:
      tags:
        - public
      summary: 灏忕▼搴忓垱寤鸿鍗曪紙涓存椂锟?
      operationId: createPublicOrder
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateOrderRequest'
      responses:
        '201':
          description: 璁㈠崟鍒涘缓鎴愬姛
          content:
            application/json:
              schema:
                type: object
                properties:
                  order_id:
                    type: string
        '400':
          $ref: '#/components/responses/ForbiddenError'
  /api/carrier/orders:
    get:
      tags:
        - carrier-order
      summary: 鑾峰彇鍙棰嗙殑璁㈠崟鍒楄〃锛堢姸锟?pending_claim)
      operationId: listCarrierOrders
      security:
        - TenantSessionAuth: []
      parameters:
        - name: page
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
          description: 椤电爜
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
          description: 姣忛〉璁板綍锟?
        - name: status
          in: query
          required: false
          schema:
            type: string
          description: 璁㈠崟鐘舵€佺瓫锟?
        - name: search
          in: query
          required: false
          schema:
            type: string
          description: 鎼滅储鍏抽敭锟?
      responses:
        '200':
          description: 鍙棰嗚鍗曞垪锟?
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderListResponse'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /api/carrier/orders/{order_id}/claim:
    put:
      tags:
        - carrier-order
      summary: 鎵胯繍鍟嗚棰嗚锟?
      operationId: claimCarrierOrder
      security:
        - TenantSessionAuth: []
      parameters:
        - name: order_id
          in: path
          required: true
          schema:
            type: integer
          description: 璁㈠崟鍞竴鏍囪瘑锛堝 tracking_number 鎴栫郴锟?ID锟?
      responses:
        '200':
          description: 璁ら鎴愬姛锛岃繑鍥炴洿鏂板悗鐨勫畬鏁磋鍗曚俊锟?
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderItem'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/carrier/orders/{order_id}/complete:
    put:
      tags:
        - carrier-order
      summary: 鎵胯繍鏂瑰畬鎴愯锟?
      operationId: completeCarrierOrder
      security:
        - TenantSessionAuth: []
      parameters:
        - name: order_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: 瀹屾垚鎴愬姛
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/carrier/orders/{order_id}/start-delivery:
    put:
      tags:
        - carrier-order
      summary: 鎵胯繍鏂瑰紑濮嬮厤閫佽锟?
      operationId: startDelivery
      security:
        - TenantSessionAuth: []
      parameters:
        - name: order_id
          in: path
          required: true
          schema:
            type: string
          description: 璁㈠崟ID
      responses:
        '200':
          description: 寮€濮嬮厤閫佹垚锟?
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Delivery started successfully
                  data:
                    type: object
                    properties:
                      order_id:
                        type: string
                        example: order_123
                      status:
                        type: string
                        example: in_transit
        '400':
          description: 璁㈠崟鐘舵€佷笉鍏佽寮€濮嬮厤锟?
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/carrier/orders/{order_id}/quote:
    post:
      operationId: submitCarrierQuote
      summary: 鎵胯繍鍟嗕负鎸囧畾璁㈠崟鎻愪氦鎶ヤ环
      description: |
        鎵胯繍鍟嗘彁浜や竴涓姤浠凤紙浠锋牸銆侀璁￠€佽揪鏃堕棿銆佸娉級缁欐寚瀹氱殑璁㈠崟锟?
        姝ゆ搷浣滀笉浼氭敼鍙樿鍗曠殑涓荤姸鎬侊紝鎶ヤ环淇℃伅灏嗗瓨鍌ㄥ湪 quotes 琛ㄤ腑锟?
        璁㈠崟鐘舵€佺殑鍙樻洿灏嗗湪鍚庣画鐨勫鎴烽€夋嫨鎴栧钩鍙版寚娲剧幆鑺傚彂鐢燂拷?
        姝ょ鐐瑰厑璁告壙杩愬晢瀵圭姸鎬佷负 'pending_claim' 鐨勮鍗曟彁浜ゆ姤浠凤拷?
      tags:
        - Carrier
        - Quote
      security:
        - TenantSessionAuth: []
      parameters:
        - name: order_id
          in: path
          required: true
          schema:
            type: integer
          description: 瑕佹姤浠风殑璁㈠崟ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                price:
                  type: number
                  format: float
                  minimum: 0.01
                  description: 鎶ヤ环閲戦
                  example: 150.75
                deliveryTime:
                  type: string
                  description: 棰勮閫佽揪鏃堕棿 (ISO 8601 鏍煎紡鎴栬嚜瀹氫箟鏍煎紡)
                  example: '2024-05-25T18:00:00Z'
                remarks:
                  type: string
                  maxLength: 500
                  description: 鎶ヤ环澶囨敞
                  example: 鍙姞鎬ワ紝浣嗛渶棰濆璐圭敤
              required:
                - price
                - deliveryTime
      responses:
        '201':
          description: 鎶ヤ环鎻愪氦鎴愬姛
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Quote submitted successfully
                  data:
                    type: object
                    properties:
                      order_id:
                        type: integer
                        example: 123
                      quote:
                        type: object
                        properties:
                          price:
                            type: number
                            format: float
                            example: 150.75
                          deliveryTime:
                            type: string
                            example: '2024-05-25T18:00:00Z'
                          remarks:
                            type: string
                            example: 鍙姞鎬ワ紝浣嗛渶棰濆璐圭敤
                      carrierId:
                        type: integer
                        example: 456
        '400':
          description: 璇锋眰鍙傛暟閿欒
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          description: 璁㈠崟鏈壘鍒版垨涓嶅厑璁告姤浠凤紙璁㈠崟鐘舵€佷笉锟?'pending_claim' 鎴栦笉灞炰簬褰撳墠鎵胯繍鍟嗭級
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: 鎵胯繍鍟嗗凡涓烘璁㈠崟鎻愪氦杩囨姤锟?
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/customer/orders/{order_id}/award:
    post:
      tags:
        - customer-order
      summary: 瀹㈡埛閫夋嫨鎵胯繍鏂癸紙鎴愪氦锟?
      operationId: awardOrderToCarrier
      security:
        - TenantSessionAuth: []
      parameters:
        - name: order_id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                carrier_tenant_id:
                  type: string
                  description: 琚€変腑鐨勬壙杩愭柟绉熸埛ID
              required:
                - carrier_tenant_id
      responses:
        '200':
          description: 璁㈠崟宸插垎閰嶇粰鎵胯繍锟?
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 璁㈠崟宸叉垚浜わ紝鎵胯繍鏂瑰凡閫氱煡
        '400':
          description: 璇锋眰鍙傛暟閿欒锛堝 carrier_tenant_id 鏃犳晥锟?
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/tenant-web/register:
    post:
      tags:
        - auth
      summary: 绉熸埛/瀹㈡埛娉ㄥ唽
      operationId: registerTenantWeb
      description: 鏂扮鎴锋垨瀹㈡埛鎻愪氦娉ㄥ唽淇℃伅锛屽垱寤鸿处鎴凤拷?
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CustomerWebRegistration'
      responses:
        '201':
          description: 娉ㄥ唽鎴愬姛
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Tenant registered successfully
                  data:
                    type: object
                    description: 鍙€夛細杩斿洖鏂板垱寤虹殑绉熸埛淇℃伅鎴栫櫥褰曞嚟锟?
                    properties:
                      tenant_id:
                        type: string
                        example: tenant_abc123
        '400':
          description: 璇锋眰鍙傛暟涓嶅畬鏁存垨鏍煎紡閿欒
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: 閭鎴栨墜鏈哄彿宸插瓨锟?
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: 鏈嶅姟鍣ㄥ唴閮ㄩ敊锟?
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /api/tenant-web/login:
    post:
      tags:
        - auth
      summary: 绉熸埛鐧诲綍/瀹㈡埛鐧诲綍
      operationId: loginTenantWeb
      description: |
        绉熸埛鎴栧鎴蜂娇鐢ㄩ偖绠辨垨鎵嬫満鍙风櫥褰曪拷?
        - 璇锋眰浣撳繀椤诲寘锟?`email` 锟?`phone` 涓殑 **浠绘剰涓€锟?*锛屼互锟?`password`锟?
        - 绀轰緥 1: { "email": "user@example.com", "password": "..." }
        - 绀轰緥 2: { "phone": "13800138000", "password": "..." }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  format: email
                  description: 绉熸埛/瀹㈡埛娉ㄥ唽閭
                  example: user@example.com
                phone:
                  type: string
                  pattern: ^1[3-9][0-9]{9}$
                  description: 绉熸埛/瀹㈡埛娉ㄥ唽鎵嬫満锟?
                  example: '13800138000'
                password:
                  type: string
                  description: 鐧诲綍瀵嗙爜
                  example: SecurePassword123!
              required:
                - password
      responses:
        '200':
          description: 鐧诲綍鎴愬姛
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Login successful
                  data:
                    type: object
                    properties:
                      tenant_id:
                        type: string
                        example: tenant_12345
                      name:
                        type: string
                        example: Example Tenant
                      roles:
                        type: array
                        items:
                          type: string
                          enum:
                            - customer
                            - carrier
                        example:
                          - customer
                    required:
                      - tenant_id
                      - name
                      - roles
        '400':
          description: 璇锋眰鍙傛暟閿欒 (缂哄皯 email 锟?phone锛屾垨鏍煎紡閿欒)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: Either email or phone must be provided along with password.
        '401':
          description: 閭鎴栧瘑鐮侀敊锟?/ 鎵嬫満鍙锋垨瀵嗙爜閿欒 / 璐︽埛鏈縺锟?
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: Invalid credentials
  /api/tenant-web/profile:
    get:
      tags:
        - auth
      summary: 鑾峰彇绉熸埛鍩烘湰淇℃伅
      operationId: getTenantProfile
      security:
        - TenantSessionAuth: []
      responses:
        '200':
          description: 绉熸埛淇℃伅
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TenantProfile'
    put:
      tags:
        - auth
      summary: 鏇存柊绉熸埛鍩烘湰淇℃伅
      operationId: updateTenantProfile
      security:
        - TenantSessionAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                contact_person:
                  type: string
                contact_phone:
                  type: string
                address:
                  type: string
      responses:
        '200':
          description: 淇℃伅鏇存柊鎴愬姛
        '401':
          $ref: '#/components/responses/UnauthorizedError'
    post:
      tags:
        - auth
      summary: 绉熸埛鍒涘缓鏂拌锟?
      operationId: createTenantOrder
      security:
        - TenantSessionAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - customer_name
                - customer_phone
                - address
                - weight
              properties:
                customer_name:
                  type: string
                customer_phone:
                  type: string
                  pattern: ^1[3-9][0-9]{9}$
                address:
                  type: string
                weight:
                  type: number
                  minimum: 0.1
      responses:
        '201':
          description: 璁㈠崟鍒涘缓鎴愬姛
          content:
            application/json:
              schema:
                type: object
                properties:
                  order_id:
                    type: string
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /api/tenant-web/profile/roles:
    get:
      tags:
        - auth
      summary: 鑾峰彇绉熸埛鍚敤鐨勮鑹插垪锟?
      operationId: getTenantRoles
      security:
        - TenantSessionAuth: []
      responses:
        '200':
          description: 瑙掕壊鍒楄〃
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: string
                      enum:
                        - customer
                        - carrier
  /api/pc-tenant/apply:
    post:
      operationId: applyPcTenant
      summary: 绉熸埛鍏ラ┗鐢宠
      description: 鏂扮鎴锋彁浜ゅ叆椹荤敵璇凤紝鍒涘缓鏂扮鎴疯处锟?
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
                - contact_person
                - contact_phone
                - email
                - password
                - roles
              properties:
                name:
                  type: string
                  description: 鍏徃鍚嶇О
                contact_person:
                  type: string
                  description: 鑱旂郴浜哄锟?
                contact_phone:
                  type: string
                  description: 鑱旂郴鐢佃瘽
                email:
                  type: string
                  description: 閭鍦板潃
                password:
                  type: string
                  minLength: 6
                  description: 瀵嗙爜锛堣嚦锟?浣嶏級
                roles:
                  type: array
                  items:
                    type: string
                    enum:
                      - customer
                      - carrier
                  description: 瑙掕壊鍒楄〃
                address:
                  type: string
                  description: 鍏徃鍦板潃
      responses:
        '201':
          description: 绉熸埛鍒涘缓鎴愬姛
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    description: 绉熸埛ID
                  name:
                    type: string
                  contact_person:
                    type: string
                  contact_phone:
                    type: string
                  email:
                    type: string
                  roles:
                    type: array
                    items:
                      type: string
                  address:
                    type: string
                  created_at:
                    type: string
                    format: date-time
        '400':
          description: 璇锋眰鍙傛暟涓嶅畬鏁存垨鏍煎紡閿欒
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: MISSING_REQUIRED_FIELDS
        '409':
          description: 閭宸插瓨锟?
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: EMAIL_ALREADY_REGISTERED
        '500':
          description: 鏈嶅姟鍣ㄥ唴閮ㄩ敊锟?
  /api/tenant-web/orders/pending:
    get:
      tags:
        - auth
      summary: 鑾峰彇鍙棰嗙殑璁㈠崟鍒楄〃锛堢姸锟?created锟?
      operationId: listPendingOrders
      security:
        - TenantSessionAuth: []
      responses:
        '200':
          description: 鍙棰嗚鍗曞垪锟?
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderListResponse'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /api/tenant-web/orders/{order_id}/claim:
    put:
      tags:
        - auth
      summary: 绉熸埛璁ら璁㈠崟
      operationId: claimOrder
      security:
        - TenantSessionAuth: []
      parameters:
        - name: order_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: 璁ら鎴愬姛
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/tenant-web/orders/{order_id}/complete:
    put:
      tags:
        - auth
      summary: 绉熸埛瀹屾垚璁㈠崟
      operationId: completeOrder
      security:
        - TenantSessionAuth: []
      parameters:
        - name: order_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: 瀹屾垚鎴愬姛
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/tenant-web/logout:
    post:
      tags:
        - auth
      summary: 绉熸埛鐧诲嚭
      operationId: logoutTenant
      security:
        - TenantSessionAuth: []
      responses:
        '200':
          description: 鐧诲嚭鎴愬姛
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 宸插畨鍏ㄩ€€锟?
  /api/matching/search-carriers:
    post:
      tags:
        - matching
      summary: 鏍规嵁璁㈠崟闇€姹傛悳绱㈠尮閰嶇殑鎵胯繍锟?
      operationId: searchMatchingCarriers
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - pickup_address
                - delivery_address
                - weight_kg
              properties:
                pickup_address:
                  type: string
                  example: 鍖椾含甯傛湞闃冲尯XX澶у帵
                delivery_address:
                  type: string
                  example: 涓婃捣甯傛郸涓滄柊鍖篩Y鍥尯
                weight_kg:
                  type: number
                  format: float
                  minimum: 0.1
                  example: 25.5
                volume_m3:
                  type: number
                  minimum: 0.01
                  example: 1.2
                required_delivery_time:
                  type: string
                  format: date-time
                  example: '2026-01-15T12:00:00Z'
                preferred_carrier_ids:
                  type: array
                  items:
                    type: string
                  description: 浼樺厛鍖归厤鐨勬壙杩愭柟ID鍒楄〃
      responses:
        '200':
          description: 鍖归厤鐨勬壙杩愭柟鍒楄〃
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/QuoteItem'
        '400':
          $ref: '#/components/responses/ForbiddenError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /api/matching/get-quote-suggestions:
    get:
      tags:
        - matching
      summary: 鑾峰彇閽堝鐗瑰畾璁㈠崟鐨勯浼版姤浠峰缓锟?
      operationId: getQuoteSuggestions
      parameters:
        - name: order_id
          in: path
          required: true
          schema:
            type: string
          description: 璁㈠崟ID
      responses:
        '200':
          description: 棰勪及鎶ヤ环寤鸿鍒楄〃
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/QuoteItem'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
  /api/carrier/quotes:
    get:
      tags:
        - carrier-order
      summary: 鑾峰彇鎵胯繍鍟嗙殑鎵€鏈夋姤浠峰垪锟?
      operationId: listCarrierQuotes
      security:
        - TenantSessionAuth: []
      parameters:
        - name: page
          in: query
          description: 椤电爜
          required: false
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          description: 姣忛〉鏁伴噺
          required: false
          schema:
            type: integer
            default: 10
        - name: order_id
          in: query
          description: 璁㈠崟ID杩囨护
          required: false
          schema:
            type: string
        - name: status
          in: query
          description: 鎶ヤ环鐘舵€佽繃锟?
          required: false
          schema:
            type: string
            enum:
              - pending
              - awarded
              - rejected
              - expired
      responses:
        '200':
          description: 鎵胯繍鍟嗘姤浠峰垪锟?
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 鑾峰彇鎴愬姛
                  data:
                    type: object
                    properties:
                      quotes:
                        type: array
                        items:
                          $ref: '#/components/schemas/QuoteItem'
                      pagination:
                        $ref: '#/components/schemas/PaginationInfo'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
  /api/admin/pricing-rules:
    get:
      tags:
        - admin-pricing
      summary: 鑾峰彇骞冲彴瀹氫环瑙勫垯鍒楄〃
      operationId: listPlatformPricingRules
      security:
        - AdminSessionAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            default: 1
          description: 椤电爜
        - name: limit
          in: query
          schema:
            type: integer
            default: 10
          description: 姣忛〉鏁伴噺
        - name: active
          in: query
          schema:
            type: boolean
          description: 鏄惁鍙繑鍥炴縺娲荤殑瑙勫垯
      responses:
        '200':
          description: 瀹氫环瑙勫垯鍒楄〃
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/PricingRule'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
    post:
      tags:
        - admin-pricing
      summary: 鍒涘缓骞冲彴瀹氫环瑙勫垯
      operationId: createPlatformPricingRule
      security:
        - AdminSessionAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreatePricingRuleRequest'
      responses:
        '201':
          description: 瀹氫环瑙勫垯鍒涘缓鎴愬姛
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 骞冲彴瀹氫环瑙勫垯鍒涘缓鎴愬姛
                  data:
                    $ref: '#/components/schemas/PricingRule'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/admin/pricing-rules/{id}:
    get:
      tags:
        - admin-pricing
      summary: 鑾峰彇鍗曚釜骞冲彴瀹氫环瑙勫垯
      operationId: getPlatformPricingRule
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: 瀹氫环瑙勫垯ID
      responses:
        '200':
          description: 瀹氫环瑙勫垯璇︽儏
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/PricingRule'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
    put:
      tags:
        - admin-pricing
      summary: 鏇存柊骞冲彴瀹氫环瑙勫垯
      operationId: updatePlatformPricingRule
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: 瀹氫环瑙勫垯ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdatePricingRuleRequest'
      responses:
        '200':
          description: 瀹氫环瑙勫垯鏇存柊鎴愬姛
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 骞冲彴瀹氫环瑙勫垯鏇存柊鎴愬姛
                  data:
                    $ref: '#/components/schemas/PricingRule'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - admin-pricing
      summary: 鍒犻櫎骞冲彴瀹氫环瑙勫垯
      operationId: deletePlatformPricingRule
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: 瀹氫环瑙勫垯ID
      responses:
        '200':
          description: 瀹氫环瑙勫垯鍒犻櫎鎴愬姛
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 骞冲彴瀹氫环瑙勫垯鍒犻櫎鎴愬姛
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/carrier/pricing-configs:
    get:
      tags:
        - carrier-pricing
      summary: 鑾峰彇鎵胯繍鍟嗗畾浠烽厤缃垪锟?
      operationId: listCarrierPricingConfigs
      security:
        - AdminSessionAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            default: 1
          description: 椤电爜
        - name: limit
          in: query
          schema:
            type: integer
            default: 10
          description: 姣忛〉鏁伴噺
        - name: carrier_id
          in: query
          schema:
            type: integer
          description: 鎵胯繍鍟咺D杩囨护
      responses:
        '200':
          description: 鎵胯繍鍟嗗畾浠烽厤缃垪锟?
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/CarrierPricingConfig'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
    post:
      tags:
        - carrier-pricing
      summary: 鍒涘缓鎵胯繍鍟嗗畾浠烽厤锟?
      operationId: createCarrierPricingConfig
      security:
        - AdminSessionAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateCarrierPricingConfigRequest'
      responses:
        '201':
          description: 鎵胯繍鍟嗗畾浠烽厤缃垱寤烘垚锟?
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 鎵胯繍鍟嗗畾浠烽厤缃垱寤烘垚锟?
                  data:
                    $ref: '#/components/schemas/CarrierPricingConfig'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/carrier/pricing-configs/{id}:
    get:
      tags:
        - carrier-pricing
      summary: 鑾峰彇鍗曚釜鎵胯繍鍟嗗畾浠烽厤锟?
      operationId: getCarrierPricingConfig
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: 瀹氫环閰嶇疆ID
      responses:
        '200':
          description: 鎵胯繍鍟嗗畾浠烽厤缃锟?
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/CarrierPricingConfig'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
    put:
      tags:
        - carrier-pricing
      summary: 鏇存柊鎵胯繍鍟嗗畾浠烽厤锟?
      operationId: updateCarrierPricingConfig
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: 瀹氫环閰嶇疆ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateCarrierPricingConfigRequest'
      responses:
        '200':
          description: 鎵胯繍鍟嗗畾浠烽厤缃洿鏂版垚锟?
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 鎵胯繍鍟嗗畾浠烽厤缃洿鏂版垚锟?
                  data:
                    $ref: '#/components/schemas/CarrierPricingConfig'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - carrier-pricing
      summary: 鍒犻櫎鎵胯繍鍟嗗畾浠烽厤锟?
      operationId: deleteCarrierPricingConfig
      security:
        - AdminSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: 瀹氫环閰嶇疆ID
      responses:
        '200':
          description: 鎵胯繍鍟嗗畾浠烽厤缃垹闄ゆ垚锟?
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 鎵胯繍鍟嗗畾浠烽厤缃垹闄ゆ垚锟?
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/order/quote:
    post:
      tags:
        - public
      summary: 鑾峰彇璁㈠崟鎶ヤ环 - 瀹㈡埛涓嬪崟鏃惰幏鍙栧瀹舵壙杩愬晢鎶ヤ环
      operationId: getOrderQuote
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - distance_km
                - duration_hours
              properties:
                distance_km:
                  type: number
                  example: 15.5
                  description: 杩愯緭璺濈锛堝叕閲岋級
                duration_hours:
                  type: number
                  example: 2.5
                  description: 棰勮杩愯緭鏃堕暱锛堝皬鏃讹級
                weight_kg:
                  type: number
                  example: 100
                  description: 璐х墿閲嶉噺锛堝叕鏂わ級
                is_cold_storage:
                  type: boolean
                  example: false
                  description: 鏄惁闇€瑕佸喎閾捐繍锟?
                time_slot:
                  type: string
                  example: morning
                  description: 鏃堕棿娈碉紙morning, afternoon, evening, night锟?
                weather_condition:
                  type: string
                  example: normal
                  enum:
                    - normal
                    - rain
                    - snow
                    - storm
                  description: 澶╂皵鐘跺喌
                region:
                  type: string
                  example: beijing_haidian
                  description: 杩愯緭鍖哄煙
                vehicle_type:
                  type: string
                  example: van
                  enum:
                    - van
                    - truck
                    - refrigerated_truck
                    - container_truck
                  description: 鎵€闇€杞﹀瀷
                pickup_address:
                  type: string
                  example: 鍖椾含甯傛捣娣€鍖轰腑鍏虫潙澶ц1锟?
                  description: 鎻愯揣鍦板潃
                delivery_address:
                  type: string
                  example: 鍖椾含甯傛湞闃冲尯鍥借锤澶у帵
                  description: 閫佽揣鍦板潃
                cargo_type:
                  type: string
                  example: electronics
                  enum:
                    - electronics
                    - clothing
                    - food
                    - medicine
                    - documents
                    - other
                  description: 璐х墿绫诲瀷
      responses:
        '200':
          description: 鎶ヤ环璁＄畻鎴愬姛
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 鎶ヤ环璁＄畻鎴愬姛
                  data:
                    type: object
                    properties:
                      order_details:
                        $ref: '#/components/schemas/OrderDetails'
                      quotes:
                        type: array
                        items:
                          $ref: '#/components/schemas/CarrierQuote'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/order/{id}/add-ons:
    post:
      tags:
        - carrier-order
      summary: 涓鸿鍗曟坊鍔犻檮鍔犺垂 - 鎵胯繍鍟嗘彁浜ら檮鍔犳湇鍔¤垂锟?
      operationId: addOrderAddons
      security:
        - TenantSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: 璁㈠崟ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - addons_config
                - addons_total
              properties:
                addons_config:
                  type: object
                  description: 闄勫姞鏈嶅姟閰嶇疆
                  properties:
                    loading_fee:
                      type: number
                      example: 50
                      description: 瑁呭嵏锟?
                    waiting_fee:
                      type: number
                      example: 30
                      description: 绛夊緟锟?
                    overtime_fee:
                      type: number
                      example: 100
                      description: 瓒呮椂锟?
                    special_handling_fee:
                      type: number
                      example: 80
                      description: 鐗规畩澶勭悊锟?
                    cold_storage_fee:
                      type: number
                      example: 40
                      description: 鍐疯棌闄勫姞锟?
                    insurance_fee:
                      type: number
                      example: 20
                      description: 淇濋櫓锟?
                    other_fees:
                      type: array
                      items:
                        type: object
                        properties:
                          name:
                            type: string
                            example: 澶滈棿閰嶉€佽垂
                          amount:
                            type: number
                            example: 60
                          description:
                            type: string
                            example: 澶滈棿閰嶉€侀澶栬垂锟?
                addons_total:
                  type: number
                  example: 230
                  description: 闄勫姞璐规€昏
                description:
                  type: string
                  example: 鍥犲鎴疯姹傚闂撮厤閫佸拰鐗规畩鍖呰浜х敓鐨勯檮鍔犺垂锟?
                  description: 闄勫姞璐硅锟?
      responses:
        '200':
          description: 闄勫姞璐规坊鍔犳垚锟?
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 璁㈠崟闄勫姞璐规坊鍔犳垚锟?
                  data:
                    type: object
                    properties:
                      order_id:
                        type: integer
                        example: 1
                      tracking_number:
                        type: string
                        example: ORD-20260209-001
                      addons_config:
                        $ref: '#/components/schemas/AddonsConfig'
                      addons_total:
                        type: number
                        example: 230
                      addons_status:
                        type: string
                        example: pending
                        enum:
                          - pending
                          - confirmed
                          - rejected
                      updated_at:
                        type: string
                        format: date-time
                        example: '2026-02-09T12:00:00Z'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/order/{id}/add-ons/confirm:
    patch:
      tags:
        - customer-order
      summary: 纭璁㈠崟闄勫姞锟?- 瀹㈡埛纭鎴栨嫆缁濇壙杩愬晢鎻愪氦鐨勯檮鍔犺垂
      operationId: confirmOrderAddons
      security:
        - TenantSessionAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: 璁㈠崟ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - confirm
              properties:
                confirm:
                  type: boolean
                  example: true
                  description: 鏄惁纭闄勫姞锟?(true=纭, false=鎷掔粷)
      responses:
        '200':
          description: 闄勫姞璐圭‘璁ょ姸鎬佹洿鏂版垚锟?
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 璁㈠崟闄勫姞璐瑰凡纭
                  data:
                    type: object
                    properties:
                      order_id:
                        type: integer
                        example: 1
                      tracking_number:
                        type: string
                        example: ORD-20260209-001
                      addons_total:
                        type: number
                        example: 230
                      addons_status:
                        type: string
                        example: confirmed
                        enum:
                          - pending
                          - confirmed
                          - rejected
                      addons_confirmation_time:
                        type: string
                        format: date-time
                        example: '2026-02-09T12:00:00Z'
                      total_price_with_addons:
                        type: number
                        example: 530
                      updated_at:
                        type: string
                        format: date-time
                        example: '2026-02-09T12:00:00Z'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/admin/orders/{order_id}/settlement:
    post:
      tags:
        - admin-order
      summary: 澶勭悊璁㈠崟缁撶畻 - 绠＄悊鍛樻墽琛岃鍗曠粨绠楁祦绋?      operationId: processSettlement
      security:
        - AdminSessionAuth: []
      parameters:
        - name: order_id
          in: path
          required: true
          schema:
            type: string
          description: 璁㈠崟ID
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                force_settle:
                  type: boolean
                  description: 鏄惁寮哄埗缁撶畻
                  example: false
      responses:
        '200':
          description: 缁撶畻澶勭悊鎴愬姛
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Settlement completed successfully
                  data:
                    type: object
                    properties:
                      order_id:
                        type: string
                        example: order_123
                      gross_amount:
                        type: number
                        example: 200.00
                      commission_amount:
                        type: number
                        example: 20.00
                      net_amount:
                        type: number
                        example: 180.00
                      order_status:
                        type: string
                        example: completed
                      wallets:
                        type: object
                        properties:
                          customer:
                            type: object
                            properties:
                              id:
                                type: integer
                              balance:
                                type: number
                          carrier:
                            type: object
                            properties:
                              id:
                                type: integer
                              balance:
                                type: number
                          platform:
                            type: object
                            properties:
                              id:
                                type: integer
                              balance:
                                type: number
                      transactions:
                        type: object
                        properties:
                          commission:
                            type: object
                            properties:
                              id:
                                type: integer
                              wallet_id:
                                type: integer
                              amount:
                                type: number
                          platform_income:
                            type: object
                            properties:
                              id:
                                type: integer
                              wallet_id:
                                type: integer
                              amount:
                                type: number
                          payment:
                            type: object
                            properties:
                              id:
                                type: integer
                              wallet_id:
                                type: integer
                              amount:
                                type: number
                          carrier_income:
                            type: object
                            properties:
                              id:
                                type: integer
                              wallet_id:
                                type: integer
                              amount:
                                type: number
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/wallet/current:
    get:
      tags:
        - wallet
      summary: 锟斤拷取锟斤拷前锟矫伙拷锟斤拷钱锟斤拷锟斤拷息
      operationId: getCurrentUserWallet
      security:
        - TenantSessionAuth: []
      responses:
        '200':
          description: 钱锟斤拷锟斤拷息锟斤拷取锟缴癸拷
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      wallet:
                        type: object
                        properties:
                          id:
                            type: integer
                            example: 1
                          owner_type:
                            type: string
                            example: "customer"
                          owner_id:
                            type: string
                            example: "tenant_123"
                          balance:
                            type: number
                            example: 1000.00
                          frozen_amount:
                            type: number
                            example: 0.00
                          status:
                            type: string
                            example: "active"
                          currency:
                            type: string
                            example: "CNY"
                          created_at:
                            type: string
                            format: date-time
                            example: "2026-02-05T10:30:00Z"
                          updated_at:
                            type: string
                            format: date-time
                            example: "2026-02-05T10:30:00Z"
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/wallet/{wallet_id}/transactions:
    get:
      tags:
        - wallet
      summary: 获取钱包交易记录
      operationId: getWalletTransactions
      security:
        - TenantSessionAuth: []
      parameters:
        - name: wallet_id
          in: path
          required: true
          schema:
            type: integer
          description: 钱包ID
        - name: page
          in: query
          required: false
          schema:
            type: integer
            default: 1
          description: 页码
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 20
            maximum: 100
          description: 每页数量
        - name: transaction_type
          in: query
          required: false
          schema:
            type: string
            enum: [income, expense]
          description: 交易类型过滤
        - name: start_date
          in: query
          required: false
          schema:
            type: string
            format: date-time
          description: 开始日期过滤
        - name: end_date
          in: query
          required: false
          schema:
            type: string
            format: date-time
          description: 结束日期过滤
      responses:
        '200':
          description: 钱包交易记录获取成功
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      transactions:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              example: 1
                            wallet_id:
                              type: integer
                              example: 1
                            order_id:
                              type: string
                              example: "order_123"
                            transaction_type:
                              type: string
                              example: "income"
                            amount:
                              type: number
                              example: 100.00
                            balance_change:
                              type: number
                              example: 100.00
                            description:
                              type: string
                              example: "订单收入"
                            reference_id:
                              type: string
                              example: "REF-123456"
                            created_at:
                              type: string
                              format: date-time
                              example: "2026-02-05T10:30:00Z"
                            processed_at:
                              type: string
                              format: date-time
                              example: "2026-02-05T10:30:00Z"
                      pagination:
                        type: object
                        properties:
                          current_page:
                            type: integer
                            example: 1
                          total_pages:
                            type: integer
                            example: 5
                          total_items:
                            type: integer
                            example: 100
                          per_page:
                            type: integer
                            example: 20
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'

