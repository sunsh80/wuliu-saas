# 承运商报价模块开发工作排期

## 第一阶段：数据库与后端API开发（预计2-3天）
**Day 1: 数据库结构与基础API**
- [ ] 创建 `platform_pricing_rules` 表（平台定价规则）
- [ ] 创建 `carrier_pricing_configs` 表（承运商配价配置）
- [ ] 实现平台定价规则API（CRUD操作）
- [ ] 实现承运商配价配置API（CRUD操作）

**Day 2: 报价计算与业务逻辑API**
- [ ] 实现订单报价计算逻辑（根据距离、时长、时间槽、天气等）
- [ ] 实现 `GET /api/order/quote` API（客户下单获取多家报价）
- [ ] 实现 `GET /api/carrier/pricing/config` API（获取承运商配价）
- [ ] 实现 `PUT /api/carrier/pricing/config` API（更新承运商配价）
- [ ] 实现智能建议算法（基于市场数据）

**Day 3: 附加费与订单状态API**
- [ ] 实现 `POST /api/order/{id}/add-ons` API（承运商提交附加费）
- [ ] 实现 `PATCH /api/order/{id}/add-ons/confirm` API（客户确认附加费）
- [ ] 更新订单表结构以支持附加费字段
- [ ] 测试API端点的完整功能

## 第二阶段：前端界面开发（预计3-4天）
**Day 4: 管理员定价配置界面**
- [ ] 开发 `/admin/pricing` 页面（平台总后台定价配置）
- [ ] 实现基础定价配置表单（起步价、里程、时长、冷藏）
- [ ] 实现15分钟粒度时间规则配置界面
- [ ] 实现承运商浮动边界设置界面

**Day 5: 承运商配价界面**
- [ ] 开发 `/carrier/pricing` 页面（承运商配价后台）
- [ ] 实现时间定价配置（高峰/平峰/低谷滑块）
- [ ] 实现冷藏额外收费配置
- [ ] 实现天气接单策略开关

**Day 6: 附加服务与智能建议界面**
- [ ] 实现附加服务配置界面（装卸服务、等待费等）
- [ ] 实现智能建议面板（推荐+3%等）
- [ ] 添加"一键采纳"功能
- [ ] 优化UI/UX设计

**Day 7: 订单报价界面整合**
- [ ] 在订单详情页添加附加费添加功能
- [ ] 实现客户确认附加费的界面
- [ ] 整合报价显示逻辑到订单列表
- [ ] 测试前端界面与后端API的集成

## 第三阶段：功能完善与测试（预计2-3天）
**Day 8: 报价算法优化与验证**
- [ ] 验证报价计算准确性（距离、时长、时间槽、天气系数）
- [ ] 测试多承运商报价排序逻辑
- [ ] 验证智能建议算法准确性
- [ ] 修复发现的问题

**Day 9: 端到端功能测试**
- [ ] 完整业务流程测试（客户下单→报价→承运商接单→附加费确认→结算）
- [ ] 承运商视角功能测试
- [ ] 客户视角功能测试
- [ ] 管理员视角功能测试

**Day 10: 性能优化与文档编写**
- [ ] 优化API性能（数据库索引、缓存策略）
- [ ] 编写API文档
- [ ] 编写用户操作手册
- [ ] 准备部署文档

## 第四阶段：部署与上线（预计1天）
**Day 11: 部署与验证**
- [ ] 在测试环境部署完整功能
- [ ] 进行最终用户验收测试
- [ ] 准备生产环境部署
- [ ] 上线并监控

## 优先级说明
- **高优先级**：数据库结构、基础API、报价计算逻辑
- **中优先级**：前端界面、附加费功能
- **低优先级**：智能建议、高级定价功能

## 风险评估
- **技术风险**：复杂的报价计算逻辑可能需要额外时间验证
- **集成风险**：前后端集成可能出现API格式不匹配问题
- **业务风险**：定价策略可能需要根据实际运营数据调整